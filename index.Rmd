--- 
title: "GO and KEGG analysis for MAPP paper"
author: "Ian U. Kouzel"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
github-repo: rstudio/bookdown-demo
description: "GO and KEGG analysis for MAPP paper"
---

# Prerequisites

## Libraries 

```{r, message = FALSE, warning = FALSE}
library(tidyverse)
library(clusterProfiler)
library(pathview)
library(enrichplot)
library(org.Hs.eg.db)
library(readr)
library(DT)
```

## Options 

```{r}
# GO analysis
minGSSize <- 10 # minimal size of genes annotated by Ontology term for testing
organismDB <- "org.Hs.eg.db" # human DB
pvalueCutoff = 0.1 # p-value cutoff
showCategory = 10 # number of GOs to plot
genes_padj_cutoff = 0.1 # padjusted cut of for genes that are different 
# between control and cancer conditions
```

## Universe set of genes

### GO (ENSEMBL)

```{r}
universe <- read.table("inclusion_tables/cassette_exons_universe_table.tsv", 
                       header = T) %>% dplyr::select(gene_id) %>% unlist() 
universe <- unique(unlist(strsplit(universe, ",")))
head(universe, 10)
length(universe)  
```

### KEGG (ENTREZ)

```{r}
ENTREZ_universe <- read.table("inclusion_tables/cassette_exons_universe_table.tsv", 
                       header = T) %>% dplyr::select(gene_id) %>% unlist() 
ENTREZ_universe <- unique(unlist(strsplit(ENTREZ_universe, ",")))
ENTREZ_universe <- bitr(ENTREZ_universe, fromType = "ENSEMBL", 
                        toType = "ENTREZID", OrgDb= organismDB) %>% 
                        dplyr::select(ENTREZID) %>% unlist()
ENTREZ_universe <- unique(unlist(strsplit(ENTREZ_universe, ",")))
head(ENTREZ_universe)
length(ENTREZ_universe)  
```

## Render the book 

```{r, eval = F}
bookdown::render_book("index.Rmd", "bookdown::gitbook")
```

```{r eval=FALSE}
install.packages("bookdown")
# or the development version
# devtools::install_github("rstudio/bookdown")
```

```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```

## Session info

```{r}
sessionInfo()
```


[["index.html", "GO and KEGG analysis for MAPP paper Chapter 1 Prerequisites 1.1 Libraries 1.2 Options 1.3 Universe set of genes 1.4 Render the book 1.5 Session info", " GO and KEGG analysis for MAPP paper Ian U. Kouzel 2022-04-21 Chapter 1 Prerequisites 1.1 Libraries library(tidyverse) library(clusterProfiler) library(pathview) library(enrichplot) library(org.Hs.eg.db) library(readr) library(DT) 1.2 Options # GO analysis minGSSize &lt;- 10 # minimal size of genes annotated by Ontology term for testing organismDB &lt;- &quot;org.Hs.eg.db&quot; # human DB pvalueCutoff = 0.1 # p-value cutoff showCategory = 10 # number of GOs to plot 1.3 Universe set of genes 1.3.1 GO (ENSEMBL) universe &lt;- read.table(&quot;data/inclusion_fractions_ALL_updated.tsv&quot;, header = T) %&gt;% dplyr::select(gene_id) %&gt;% unlist() universe &lt;- unique(unlist(strsplit(universe, &quot;,&quot;))) head(universe, 10) ## [1] &quot;ENSG00000174371&quot; &quot;ENSG00000117009&quot; &quot;ENSG00000284770&quot; &quot;ENSG00000285053&quot; ## [5] &quot;ENSG00000228058&quot; &quot;ENSG00000143774&quot; &quot;ENSG00000143801&quot; &quot;ENSG00000225334&quot; ## [9] &quot;ENSG00000143353&quot; &quot;ENSG00000117691&quot; length(universe) ## [1] 11231 1.3.2 KEGG (ENTREZ) ENTREZ_universe &lt;- read.table(&quot;data/inclusion_fractions_ALL_updated.tsv&quot;, header = T) %&gt;% dplyr::select(gene_name) %&gt;% unlist() ENTREZ_universe &lt;- unique(unlist(strsplit(ENTREZ_universe, &quot;,&quot;))) ENTREZ_universe &lt;- bitr(ENTREZ_universe, fromType = &quot;SYMBOL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% dplyr::select(ENTREZID) %&gt;% unlist() ## &#39;select()&#39; returned 1:many mapping between keys and columns ## Warning in bitr(ENTREZ_universe, fromType = &quot;SYMBOL&quot;, toType = &quot;ENTREZID&quot;, : ## 3.87% of input gene IDs are fail to map... ENTREZ_universe &lt;- unique(unlist(strsplit(ENTREZ_universe, &quot;,&quot;))) head(ENTREZ_universe) ## [1] &quot;9156&quot; &quot;8564&quot; &quot;6905&quot; &quot;101927532&quot; &quot;2987&quot; &quot;5664&quot; length(ENTREZ_universe) ## [1] 10798 1.4 Render the book bookdown::render_book(&quot;index.Rmd&quot;, &quot;bookdown::gitbook&quot;) install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) 1.5 Session info sessionInfo() ## R version 4.1.2 (2021-11-01) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Monterey 12.0.1 ## ## Matrix products: default ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats4 stats graphics grDevices utils datasets methods ## [8] base ## ## other attached packages: ## [1] DT_0.20 org.Hs.eg.db_3.14.0 AnnotationDbi_1.56.2 ## [4] IRanges_2.28.0 S4Vectors_0.32.3 Biobase_2.54.0 ## [7] BiocGenerics_0.40.0 enrichplot_1.14.2 pathview_1.34.0 ## [10] clusterProfiler_4.2.2 forcats_0.5.1 stringr_1.4.0 ## [13] dplyr_1.0.7 purrr_0.3.4 readr_2.1.1 ## [16] tidyr_1.1.4 tibble_3.1.6 ggplot2_3.3.5 ## [19] tidyverse_1.3.1 ## ## loaded via a namespace (and not attached): ## [1] readxl_1.3.1 shadowtext_0.1.1 backports_1.4.0 ## [4] fastmatch_1.1-3 plyr_1.8.6 igraph_1.3.0 ## [7] lazyeval_0.2.2 splines_4.1.2 crosstalk_1.2.0 ## [10] BiocParallel_1.28.2 GenomeInfoDb_1.30.0 digest_0.6.29 ## [13] yulab.utils_0.0.4 htmltools_0.5.2 GOSemSim_2.20.0 ## [16] viridis_0.6.2 GO.db_3.14.0 fansi_0.5.0 ## [19] magrittr_2.0.1 memoise_2.0.1 tzdb_0.2.0 ## [22] Biostrings_2.62.0 graphlayouts_0.8.0 modelr_0.1.8 ## [25] colorspace_2.0-2 blob_1.2.2 rvest_1.0.2 ## [28] ggrepel_0.9.1 haven_2.4.3 xfun_0.28 ## [31] crayon_1.4.2 RCurl_1.98-1.5 jsonlite_1.7.2 ## [34] graph_1.72.0 scatterpie_0.1.7 ape_5.5 ## [37] glue_1.5.1 polyclip_1.10-0 gtable_0.3.0 ## [40] zlibbioc_1.40.0 XVector_0.34.0 Rgraphviz_2.38.0 ## [43] scales_1.1.1 DOSE_3.20.1 DBI_1.1.1 ## [46] Rcpp_1.0.7 viridisLite_0.4.0 gridGraphics_0.5-1 ## [49] tidytree_0.3.9 bit_4.0.4 htmlwidgets_1.5.4 ## [52] httr_1.4.2 fgsea_1.20.0 RColorBrewer_1.1-2 ## [55] ellipsis_0.3.2 pkgconfig_2.0.3 XML_3.99-0.8 ## [58] farver_2.1.0 sass_0.4.0 dbplyr_2.1.1 ## [61] utf8_1.2.2 ggplotify_0.1.0 tidyselect_1.1.1 ## [64] labeling_0.4.2 rlang_0.4.12 reshape2_1.4.4 ## [67] munsell_0.5.0 cellranger_1.1.0 tools_4.1.2 ## [70] cachem_1.0.6 downloader_0.4 cli_3.1.0 ## [73] generics_0.1.1 RSQLite_2.2.9 broom_0.7.10 ## [76] evaluate_0.14 fastmap_1.1.0 yaml_2.2.1 ## [79] ggtree_3.2.1 knitr_1.36 bit64_4.0.5 ## [82] fs_1.5.1 tidygraph_1.2.1 KEGGREST_1.34.0 ## [85] ggraph_2.0.5 nlme_3.1-153 KEGGgraph_1.54.0 ## [88] aplot_0.1.2 DO.db_2.9 xml2_1.3.3 ## [91] compiler_4.1.2 rstudioapi_0.13 png_0.1-7 ## [94] reprex_2.0.1 treeio_1.18.1 tweenr_1.0.2 ## [97] bslib_0.3.1 stringi_1.7.6 highr_0.9 ## [100] lattice_0.20-45 Matrix_1.3-4 vctrs_0.3.8 ## [103] pillar_1.6.4 lifecycle_1.0.1 jquerylib_0.1.4 ## [106] data.table_1.14.2 bitops_1.0-7 patchwork_1.1.1 ## [109] qvalue_2.26.0 R6_2.5.1 bookdown_0.24 ## [112] gridExtra_2.3 MASS_7.3-54 assertthat_0.2.1 ## [115] withr_2.4.3 GenomeInfoDbData_1.2.7 parallel_4.1.2 ## [118] hms_1.1.1 grid_4.1.2 ggfun_0.0.4 ## [121] rmarkdown_2.11 ggforce_0.3.3 lubridate_1.8.0 "],["go-and-kegg-common-targets-05.html", "Chapter 2 GO and KEGG: common targets 05 2.1 Load the data 2.2 Gene ontology (GO) 2.3 KEGG", " Chapter 2 GO and KEGG: common targets 05 2.1 Load the data data_MAPP &lt;- read.table(&quot;data/inclusion_fractions_FG_COMMON_targets_05.tsv&quot;, header = T) DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 2.2 Gene ontology (GO) 2.2.1 Prepare the gene list genes &lt;- data_MAPP %&gt;% arrange(desc(ABSDIFF)) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 ## &quot;ENSG00000136153&quot; &quot;ENSG00000007047&quot; &quot;ENSG00000124313&quot; &quot;ENSG00000197959&quot; ## gene_id5 gene_id6 ## &quot;ENSG00000108262&quot; &quot;ENSG00000163531&quot; 2.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 2.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 2.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 2.3 KEGG 2.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:1 mapping between keys and columns ## Warning in bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, : ## 2.67% of input gene IDs are fail to map... head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.8582215 -0.8257557 -0.7253903 -0.6807944 -0.6760494 -0.6457411 -0.6326151 ## [8] -0.6300727 -0.6063017 -0.5928132 -0.5780755 -0.5733221 -0.4860983 -0.4858054 ## [15] -0.4778612 -0.4472303 -0.4426144 -0.4403571 -0.4208322 -0.4148864 -0.4127889 ## [22] -0.4079777 -0.3994337 -0.3937732 -0.3909146 -0.3734401 -0.3588750 -0.3283974 ## [29] -0.3216978 -0.3017486 -0.3011440 -0.2984512 -0.2894842 -0.2802866 -0.2797117 ## [36] -0.2696532 -0.2621230 -0.2617458 -0.2542323 -0.2437877 -0.2392907 -0.2267695 ## [43] -0.2200261 -0.2197872 -0.2173284 -0.2160939 -0.2137278 -0.2082776 -0.2082300 ## [50] -0.2070782 -0.2067205 -0.1968178 -0.1946038 -0.1865218 -0.1729623 -0.1718987 ## [57] -0.1708498 -0.1708320 -0.1647432 -0.1597974 -0.1555658 -0.1531746 -0.1529033 ## [64] -0.1460860 -0.1396099 -0.1310301 -0.1251844 -0.1179384 -0.1164545 -0.1164141 ## [71] -0.1157782 -0.1140892 -0.1125992 -0.1084042 -0.1039281 -0.1002529 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 4008 57787 23096 26052 28964 23114 91012 ## -0.8582215 -0.8257557 -0.7253903 -0.6807944 -0.6760494 -0.6457411 -0.6326151 ## 23114 8541 1803 54478 22885 63027 22864 ## -0.6300727 -0.6063017 -0.5928132 -0.5780755 -0.5733221 -0.4860983 -0.4858054 ## 157574 23229 84448 57217 23095 54940 92840 ## -0.4778612 -0.4472303 -0.4426144 -0.4403571 -0.4208322 -0.4148864 -0.4127889 ## 490 2036 10892 1838 6334 79038 283234 ## -0.4079777 -0.3994337 -0.3937732 -0.3909146 -0.3734401 -0.3588750 -0.3283974 ## 53826 54828 2987 57646 3778 9659 57706 ## -0.3216978 -0.3017486 -0.3011440 -0.2984512 -0.2894842 -0.2802866 -0.2797117 ## 55627 54413 55054 818 56947 9149 5909 ## -0.2696532 -0.2621230 -0.2617458 -0.2542323 -0.2437877 -0.2392907 -0.2267695 ## 51195 818 23199 445815 79772 55614 115704 ## -0.2200261 -0.2197872 -0.2173284 -0.2160939 -0.2137278 -0.2082776 -0.2082300 ## 288 55605 6249 10675 2260 130733 29959 ## -0.2070782 -0.2067205 -0.1968178 -0.1946038 -0.1865218 -0.1729623 -0.1718987 ## 547 65258 9650 54940 55246 54462 23139 ## -0.1708498 -0.1708320 -0.1647432 -0.1597974 -0.1555658 -0.1531746 -0.1529033 ## 4926 23043 134 152926 23143 9873 29803 ## -0.1460860 -0.1396099 -0.1310301 -0.1251844 -0.1179384 -0.1164545 -0.1164141 ## 25829 2801 84167 54808 162968 23499 ## -0.1157782 -0.1140892 -0.1125992 -0.1084042 -0.1039281 -0.1002529 2.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["go-and-kegg-common-targets-09.html", "Chapter 3 GO and KEGG: common targets 09 3.1 Load the data 3.2 Gene ontology (GO) 3.3 KEGG", " Chapter 3 GO and KEGG: common targets 09 3.1 Load the data data_MAPP &lt;- read.table(&quot;data/inclusion_fractions_FG_COMMON_targets_09.tsv&quot;, header = T) DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 3.2 Gene ontology (GO) 3.2.1 Prepare the gene list genes &lt;- data_MAPP %&gt;% arrange(desc(ABSDIFF)) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 ## &quot;ENSG00000136153&quot; &quot;ENSG00000108262&quot; &quot;ENSG00000129195&quot; &quot;ENSG00000173210&quot; ## gene_id5 gene_id6 ## &quot;ENSG00000131089&quot; &quot;ENSG00000054523&quot; 3.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 3.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 3.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 3.3 KEGG 3.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:1 mapping between keys and columns ## Warning in bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, : ## 3.03% of input gene IDs are fail to map... head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.8582215 -0.6760494 -0.5780755 -0.5733221 -0.4472303 -0.4208322 -0.4127889 ## [8] -0.4079777 -0.3994337 -0.3216978 -0.2984512 -0.2894842 -0.2802866 -0.2797117 ## [15] -0.2696532 -0.2621230 -0.2617458 -0.2542323 -0.2082776 -0.2082300 -0.2070782 ## [22] -0.2067205 -0.1968178 -0.1718987 -0.1647432 -0.1531746 -0.1529033 -0.1251844 ## [29] -0.1157782 -0.1140892 -0.1125992 -0.1084042 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 4008 28964 54478 22885 23229 23095 92840 ## -0.8582215 -0.6760494 -0.5780755 -0.5733221 -0.4472303 -0.4208322 -0.4127889 ## 490 2036 53826 57646 3778 9659 57706 ## -0.4079777 -0.3994337 -0.3216978 -0.2984512 -0.2894842 -0.2802866 -0.2797117 ## 55627 54413 55054 818 55614 115704 288 ## -0.2696532 -0.2621230 -0.2617458 -0.2542323 -0.2082776 -0.2082300 -0.2070782 ## 55605 6249 29959 9650 54462 23139 152926 ## -0.2067205 -0.1968178 -0.1718987 -0.1647432 -0.1531746 -0.1529033 -0.1251844 ## 25829 2801 84167 54808 ## -0.1157782 -0.1140892 -0.1125992 -0.1084042 3.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; "],["go-and-kegg-ptbp1-targets-05.html", "Chapter 4 GO and KEGG: PTBP1 targets 05 4.1 Load the data 4.2 Gene ontology (GO) 4.3 KEGG", " Chapter 4 GO and KEGG: PTBP1 targets 05 4.1 Load the data data_MAPP &lt;- read.table(&quot;data/inclusion_fractions_FG_PTBP1_targets_05.tsv&quot;, header = T) DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 4.2 Gene ontology (GO) 4.2.1 Prepare the gene list genes &lt;- data_MAPP %&gt;% arrange(desc(ABSDIFF)) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 ## &quot;ENSG00000163618&quot; &quot;ENSG00000115155&quot; &quot;ENSG00000108826&quot; &quot;ENSG00000162065&quot; ## gene_id5 gene_id6 ## &quot;ENSG00000070961&quot; &quot;ENSG00000121152&quot; 4.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 4.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 4.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 4.3 KEGG 4.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:many mapping between keys and columns ## Warning in bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, : ## 2.82% of input gene IDs are fail to map... head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.9126298 -0.8385180 -0.8272923 -0.8211457 -0.7876977 -0.7829234 ## [7] -0.7816336 -0.7703424 -0.7609410 -0.7545117 -0.7538040 -0.7392774 ## [13] -0.7386252 -0.7315559 -0.7304114 -0.7278021 -0.7037560 -0.7016754 ## [19] -0.6905245 -0.6771402 -0.6733009 -0.6701628 -0.6653290 -0.6566498 ## [25] -0.6518531 -0.6472132 -0.6348466 -0.6332485 -0.6296005 -0.6192291 ## [31] -0.6181530 -0.6157997 -0.6129218 -0.6123112 -0.6097948 -0.6059942 ## [37] -0.6010476 -0.5931187 -0.5917718 -0.5916966 -0.5904993 -0.5900587 ## [43] -0.5879064 -0.5836148 -0.5821286 -0.5657608 -0.5649354 -0.5606538 ## [49] -0.5575119 -0.5540025 -0.5525882 -0.5514768 -0.5396163 -0.5372275 ## [55] -0.5364591 -0.5343243 -0.5342572 -0.5294124 -0.5249502 -0.5238560 ## [61] -0.5196827 -0.5183596 -0.5177126 -0.5112932 -0.5112932 -0.5109552 ## [67] -0.5108008 -0.5076505 -0.5063009 -0.5051949 -0.5033137 -0.5021750 ## [73] -0.5000163 -0.4950297 -0.4936289 -0.4925846 -0.4913249 -0.4903987 ## [79] -0.4888514 -0.4884007 -0.4844082 -0.4827336 -0.4807160 -0.4806682 ## [85] -0.4741368 -0.4718288 -0.4687341 -0.4659565 -0.4624971 -0.4593576 ## [91] -0.4543094 -0.4542531 -0.4537442 -0.4469815 -0.4460539 -0.4454511 ## [97] -0.4451903 -0.4436697 -0.4354594 -0.4325359 -0.4321602 -0.4311299 ## [103] -0.4310449 -0.4308062 -0.4291453 -0.4285109 -0.4269757 -0.4269065 ## [109] -0.4259093 -0.4238074 -0.4198884 -0.4197553 -0.4188879 -0.4174422 ## [115] -0.4160806 -0.4149449 -0.4126904 -0.4109248 -0.4057942 -0.4020125 ## [121] -0.4014429 -0.4009934 -0.4009405 -0.4009356 -0.3999912 -0.3991268 ## [127] -0.3967703 -0.3963633 -0.3960224 -0.3940944 -0.3904581 -0.3901452 ## [133] -0.3884739 -0.3875304 -0.3865543 -0.3848030 -0.3844747 -0.3842678 ## [139] -0.3835402 -0.3833293 -0.3821309 -0.3801281 -0.3796960 -0.3790270 ## [145] -0.3741013 -0.3740675 -0.3736532 -0.3722794 -0.3706586 -0.3702094 ## [151] -0.3701578 -0.3691189 -0.3647902 -0.3642852 -0.3642194 -0.3624454 ## [157] -0.3593748 -0.3586005 -0.3547060 -0.3546985 -0.3545355 -0.3511584 ## [163] -0.3508964 -0.3506309 -0.3504221 -0.3494306 -0.3491957 -0.3481784 ## [169] -0.3457038 -0.3431746 -0.3429192 -0.3418848 -0.3386760 -0.3372391 ## [175] -0.3370899 -0.3364469 -0.3352155 -0.3349596 -0.3339148 -0.3331927 ## [181] -0.3308899 -0.3302233 -0.3297620 -0.3276181 -0.3272651 -0.3269538 ## [187] -0.3267098 -0.3257368 -0.3255545 -0.3247944 -0.3246836 -0.3232625 ## [193] -0.3201557 -0.3184687 -0.3180534 -0.3148234 -0.3127597 -0.3124528 ## [199] -0.3124528 -0.3115548 -0.3112865 -0.3068952 -0.3067734 -0.3061729 ## [205] -0.3047922 -0.3047073 -0.3019194 -0.3009768 -0.2995976 -0.2975426 ## [211] -0.2959288 -0.2952774 -0.2933795 -0.2920354 -0.2910938 -0.2903050 ## [217] -0.2900476 -0.2889355 -0.2865685 -0.2859398 -0.2851542 -0.2829154 ## [223] -0.2818072 -0.2807892 -0.2804577 -0.2794122 -0.2783305 -0.2769099 ## [229] -0.2769029 -0.2760492 -0.2714834 -0.2705176 -0.2699802 -0.2699676 ## [235] -0.2684956 -0.2662864 -0.2648395 -0.2629684 -0.2612156 -0.2596390 ## [241] -0.2557764 -0.2538541 -0.2524712 -0.2513457 -0.2493478 -0.2482621 ## [247] -0.2469973 -0.2464798 -0.2461909 -0.2457179 -0.2456629 -0.2452625 ## [253] -0.2447349 -0.2442730 -0.2429050 -0.2426450 -0.2413380 -0.2412970 ## [259] -0.2406507 -0.2393380 -0.2390682 -0.2388961 -0.2380019 -0.2353654 ## [265] -0.2351941 -0.2332361 -0.2309192 -0.2309037 -0.2308256 -0.2291128 ## [271] -0.2270190 -0.2255429 -0.2248951 -0.2247788 -0.2243185 -0.2236997 ## [277] -0.2229465 -0.2222335 -0.2217250 -0.2217054 -0.2213862 -0.2207257 ## [283] -0.2199009 -0.2182984 -0.2178506 -0.2154682 -0.2150387 -0.2149225 ## [289] -0.2148996 -0.2135622 -0.2133000 -0.2115725 -0.2107355 -0.2082274 ## [295] -0.2073162 -0.2073149 -0.2068285 -0.2037670 -0.2035520 -0.2025265 ## [301] -0.2022403 -0.2008807 -0.2008152 -0.2000145 -0.1998854 -0.1987866 ## [307] -0.1987341 -0.1966885 -0.1963556 -0.1958811 -0.1955626 -0.1950308 ## [313] -0.1949126 -0.1948027 -0.1946637 -0.1935917 -0.1935713 -0.1935360 ## [319] -0.1933085 -0.1929564 -0.1927534 -0.1920016 -0.1910513 -0.1903314 ## [325] -0.1901731 -0.1898200 -0.1875737 -0.1865831 -0.1862132 -0.1855274 ## [331] -0.1854042 -0.1848870 -0.1835184 -0.1833165 -0.1819920 -0.1805731 ## [337] -0.1804066 -0.1795522 -0.1790908 -0.1774805 -0.1766813 -0.1749731 ## [343] -0.1746310 -0.1739784 -0.1735915 -0.1734591 -0.1728938 -0.1724504 ## [349] -0.1723689 -0.1717806 -0.1710204 -0.1709129 -0.1706142 -0.1699667 ## [355] -0.1696455 -0.1690269 -0.1689735 -0.1688073 -0.1683748 -0.1683733 ## [361] -0.1678132 -0.1670951 -0.1670951 -0.1669835 -0.1667740 -0.1664784 ## [367] -0.1655258 -0.1654724 -0.1654040 -0.1652376 -0.1651035 -0.1649289 ## [373] -0.1636691 -0.1634691 -0.1624315 -0.1622023 -0.1613483 -0.1611628 ## [379] -0.1608525 -0.1606652 -0.1594169 -0.1589819 -0.1586718 -0.1586718 ## [385] -0.1586525 -0.1581205 -0.1579830 -0.1571857 -0.1568697 -0.1567624 ## [391] -0.1566988 -0.1566052 -0.1561604 -0.1555752 -0.1540316 -0.1530218 ## [397] -0.1520580 -0.1498556 -0.1492102 -0.1491239 -0.1485174 -0.1474034 ## [403] -0.1473753 -0.1469122 -0.1469071 -0.1465026 -0.1460466 -0.1458503 ## [409] -0.1453661 -0.1453564 -0.1446696 -0.1431407 -0.1424700 -0.1419632 ## [415] -0.1419189 -0.1418785 -0.1416117 -0.1414871 -0.1411882 -0.1409515 ## [421] -0.1407606 -0.1405595 -0.1404169 -0.1391474 -0.1378485 -0.1376388 ## [427] -0.1375334 -0.1369290 -0.1368327 -0.1366580 -0.1365163 -0.1363543 ## [433] -0.1363092 -0.1360100 -0.1359647 -0.1358420 -0.1353834 -0.1340605 ## [439] -0.1340434 -0.1331417 -0.1327681 -0.1324081 -0.1321598 -0.1317851 ## [445] -0.1316543 -0.1308592 -0.1305784 -0.1304436 -0.1299672 -0.1298179 ## [451] -0.1298076 -0.1294887 -0.1291402 -0.1289672 -0.1285852 -0.1285852 ## [457] -0.1283329 -0.1281357 -0.1281357 -0.1280428 -0.1258038 -0.1256692 ## [463] -0.1256112 -0.1256095 -0.1255415 -0.1255313 -0.1248949 -0.1246227 ## [469] -0.1243630 -0.1243179 -0.1236767 -0.1235413 -0.1234350 -0.1229931 ## [475] -0.1222455 -0.1216904 -0.1215446 -0.1214933 -0.1210547 -0.1208799 ## [481] -0.1206900 -0.1205363 -0.1205247 -0.1200543 -0.1192673 -0.1192363 ## [487] -0.1192172 -0.1191802 -0.1185624 -0.1181123 -0.1178447 -0.1175149 ## [493] -0.1171685 -0.1169635 -0.1168536 -0.1163220 -0.1156561 -0.1152561 ## [499] -0.1150404 -0.1137457 -0.1133740 -0.1131434 -0.1129219 -0.1127595 ## [505] -0.1121337 -0.1116281 -0.1115992 -0.1111831 -0.1105608 -0.1102104 ## [511] -0.1090269 -0.1088682 -0.1087378 -0.1087291 -0.1085317 -0.1082192 ## [517] -0.1075608 -0.1074890 -0.1074767 -0.1071432 -0.1067727 -0.1063731 ## [523] -0.1044109 -0.1039277 -0.1038658 -0.1034704 -0.1032697 -0.1028410 ## [529] -0.1021158 -0.1018516 -0.1010673 -0.1009685 -0.1008330 -0.1002978 ## [535] -0.1000736 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 8618 9381 51264 57465 490 23397 1770 ## -0.9126298 -0.8385180 -0.8272923 -0.8211457 -0.7876977 -0.7829234 -0.7816336 ## 53826 54940 91012 253782 94122 6550 90523 ## -0.7703424 -0.7609410 -0.7545117 -0.7538040 -0.7392774 -0.7386252 -0.7315559 ## 8470 782 3897 23301 25803 131408 114904 ## -0.7304114 -0.7278021 -0.7037560 -0.7016754 -0.6905245 -0.6771402 -0.6733009 ## 54806 10396 4731 197335 10152 3897 83744 ## -0.6701628 -0.6653290 -0.6566498 -0.6518531 -0.6472132 -0.6348466 -0.6332485 ## 321 26091 10579 80823 2550 8867 7168 ## -0.6296005 -0.6192291 -0.6181530 -0.6157997 -0.6129218 -0.6123112 -0.6097948 ## 55619 55683 118813 10579 1211 8618 118980 ## -0.6059942 -0.6010476 -0.5931187 -0.5917718 -0.5916966 -0.5904993 -0.5900587 ## 51135 23125 57017 55728 7163 322 29911 ## -0.5879064 -0.5836148 -0.5821286 -0.5657608 -0.5649354 -0.5606538 -0.5575119 ## 8874 114880 1639 9637 23061 54812 4205 ## -0.5540025 -0.5525882 -0.5514768 -0.5396163 -0.5372275 -0.5364591 -0.5343243 ## 23108 57655 5800 55796 51199 1627 57176 ## -0.5342572 -0.5294124 -0.5249502 -0.5238560 -0.5196827 -0.5183596 -0.5177126 ## 57150 63914 51123 64149 123591 1739 23005 ## -0.5112932 -0.5112932 -0.5109552 -0.5108008 -0.5076505 -0.5063009 -0.5051949 ## 23048 11127 64840 4628 56479 274 23136 ## -0.5033137 -0.5021750 -0.5000163 -0.4950297 -0.4936289 -0.4925846 -0.4913249 ## 5719 27032 50488 10150 5723 9776 9764 ## -0.4903987 -0.4888514 -0.4884007 -0.4844082 -0.4827336 -0.4807160 -0.4806682 ## 9016 55054 1981 51614 10188 728340 1797 ## -0.4741368 -0.4718288 -0.4687341 -0.4659565 -0.4624971 -0.4593576 -0.4543094 ## 57142 10497 23564 93643 1211 57217 2036 ## -0.4542531 -0.4537442 -0.4469815 -0.4460539 -0.4454511 -0.4451903 -0.4436697 ## 253959 84892 10580 8567 11200 151835 26115 ## -0.4354594 -0.4325359 -0.4321602 -0.4311299 -0.4310449 -0.4308062 -0.4291453 ## 60509 81502 160 4123 2897 2217 7410 ## -0.4285109 -0.4269757 -0.4269065 -0.4259093 -0.4238074 -0.4198884 -0.4197553 ## 5158 2044 29906 51265 54899 56980 153768 ## -0.4188879 -0.4174422 -0.4160806 -0.4149449 -0.4126904 -0.4109248 -0.4057942 ## 5530 4194 408 22872 152137 9612 84698 ## -0.4020125 -0.4014429 -0.4009934 -0.4009405 -0.4009356 -0.3999912 -0.3991268 ## 64840 254251 23187 55738 153328 2260 5087 ## -0.3967703 -0.3963633 -0.3960224 -0.3940944 -0.3904581 -0.3901452 -0.3884739 ## 94239 5802 23552 7410 79740 5533 9887 ## -0.3875304 -0.3865543 -0.3848030 -0.3844747 -0.3842678 -0.3835402 -0.3833293 ## 80227 2542 29980 57179 9112 9209 23421 ## -0.3821309 -0.3801281 -0.3796960 -0.3790270 -0.3741013 -0.3740675 -0.3736532 ## 81502 84331 55291 79734 2181 64753 51665 ## -0.3722794 -0.3706586 -0.3702094 -0.3701578 -0.3691189 -0.3647902 -0.3642852 ## 83707 5909 23335 65243 6733 23157 23265 ## -0.3642194 -0.3624454 -0.3593748 -0.3586005 -0.3547060 -0.3546985 -0.3545355 ## 528 105369748 88 6676 8737 5291 10606 ## -0.3511584 -0.3508964 -0.3506309 -0.3504221 -0.3494306 -0.3491957 -0.3481784 ## 79033 100287616 66035 91404 114991 3778 90203 ## -0.3457038 -0.3431746 -0.3429192 -0.3418848 -0.3386760 -0.3372391 -0.3370899 ## 7739 93664 162 1305 10498 4140 376497 ## -0.3364469 -0.3352155 -0.3349596 -0.3339148 -0.3331927 -0.3308899 -0.3302233 ## 2036 54545 150763 166614 51092 114789 1841 ## -0.3297620 -0.3276181 -0.3272651 -0.3269538 -0.3267098 -0.3257368 -0.3255545 ## 60682 493 9209 56904 4301 55768 8496 ## -0.3247944 -0.3246836 -0.3232625 -0.3201557 -0.3184687 -0.3180534 -0.3148234 ## 23041 9138 100505585 5792 3117 80227 375790 ## -0.3127597 -0.3124528 -0.3124528 -0.3115548 -0.3112865 -0.3068952 -0.3067734 ## 64577 8760 1759 9901 163 1729 55870 ## -0.3061729 -0.3047922 -0.3047073 -0.3019194 -0.3009768 -0.2995976 -0.2975426 ## 23317 7164 55578 8745 782 5433 776 ## -0.2959288 -0.2952774 -0.2933795 -0.2920354 -0.2910938 -0.2903050 -0.2900476 ## 7771 100131434 23597 92558 283899 161 2710 ## -0.2889355 -0.2865685 -0.2859398 -0.2851542 -0.2829154 -0.2818072 -0.2807892 ## 22839 5532 93589 23063 2146 7164 23513 ## -0.2804577 -0.2794122 -0.2783305 -0.2769099 -0.2769029 -0.2760492 -0.2714834 ## 23265 6942 5863 23065 4629 9815 145389 ## -0.2705176 -0.2699802 -0.2699676 -0.2684956 -0.2662864 -0.2648395 -0.2629684 ## 421 10152 4645 23266 30837 91012 84904 ## -0.2612156 -0.2596390 -0.2557764 -0.2538541 -0.2524712 -0.2513457 -0.2493478 ## 9112 81831 84809 8573 9223 5793 55968 ## -0.2482621 -0.2469973 -0.2464798 -0.2461909 -0.2457179 -0.2456629 -0.2452625 ## 90525 101929145 29109 1478 8867 22795 9847 ## -0.2447349 -0.2442730 -0.2429050 -0.2426450 -0.2413380 -0.2412970 -0.2406507 ## 89796 2778 81544 5358 8997 10540 5209 ## -0.2393380 -0.2390682 -0.2388961 -0.2380019 -0.2353654 -0.2351941 -0.2332361 ## 9765 7587 22818 55839 121227 7165 58513 ## -0.2309192 -0.2309037 -0.2308256 -0.2291128 -0.2270190 -0.2255429 -0.2248951 ## 26505 554203 100526693 23059 9639 23033 203286 ## -0.2247788 -0.2243185 -0.2236997 -0.2229465 -0.2222335 -0.2217250 -0.2217054 ## 55268 25957 57819 9542 54472 581 113157 ## -0.2213862 -0.2207257 -0.2199009 -0.2182984 -0.2178506 -0.2154682 -0.2150387 ## 204 84516 8715 81545 399979 80179 23332 ## -0.2149225 -0.2148996 -0.2135622 -0.2133000 -0.2115725 -0.2107355 -0.2082274 ## 114819 1390 252983 6605 10006 11235 10210 ## -0.2073162 -0.2073149 -0.2068285 -0.2037670 -0.2035520 -0.2025265 -0.2022403 ## 23059 10540 54971 54585 8945 441951 3274 ## -0.2008807 -0.2008152 -0.2000145 -0.1998854 -0.1987866 -0.1987341 -0.1966885 ## 23028 2550 123872 5446 64221 7375 26065 ## -0.1963556 -0.1958811 -0.1955626 -0.1950308 -0.1949126 -0.1948027 -0.1946637 ## 10536 55840 6942 64221 25875 5977 340267 ## -0.1935917 -0.1935713 -0.1935360 -0.1933085 -0.1929564 -0.1927534 -0.1920016 ## 10076 987 285367 92241 816 868 6938 ## -0.1910513 -0.1903314 -0.1901731 -0.1898200 -0.1875737 -0.1865831 -0.1862132 ## 10580 4698 83636 84259 143570 23518 55740 ## -0.1855274 -0.1854042 -0.1848870 -0.1835184 -0.1833165 -0.1819920 -0.1805731 ## 57396 4684 10436 57476 79784 81562 9737 ## -0.1804066 -0.1795522 -0.1790908 -0.1774805 -0.1766813 -0.1749731 -0.1746310 ## 3708 10076 55577 334 92154 220869 11060 ## -0.1739784 -0.1735915 -0.1734591 -0.1728938 -0.1724504 -0.1723689 -0.1717806 ## 34 10516 4967 23504 146956 23559 5909 ## -0.1710204 -0.1709129 -0.1706142 -0.1699667 -0.1696455 -0.1690269 -0.1689735 ## 8514 56965 4179 399818 29970 100505385 2734 ## -0.1688073 -0.1683748 -0.1683733 -0.1678132 -0.1670951 -0.1670951 -0.1669835 ## 51619 23583 51538 3429 8844 55604 9104 ## -0.1667740 -0.1664784 -0.1655258 -0.1654724 -0.1654040 -0.1652376 -0.1651035 ## 100421372 58155 10087 56996 5066 145864 9727 ## -0.1649289 -0.1636691 -0.1634691 -0.1624315 -0.1622023 -0.1613483 -0.1611628 ## 288 4957 65125 4253 57150 63914 208 ## -0.1608525 -0.1606652 -0.1594169 -0.1589819 -0.1586718 -0.1586718 -0.1586525 ## 25904 57666 8897 10180 22885 57154 83943 ## -0.1581205 -0.1579830 -0.1571857 -0.1568697 -0.1567624 -0.1566988 -0.1566052 ## 7042 8514 84216 85302 80179 9048 26012 ## -0.1561604 -0.1555752 -0.1540316 -0.1530218 -0.1520580 -0.1498556 -0.1492102 ## 6342 6251 10520 57620 55132 8479 54820 ## -0.1491239 -0.1485174 -0.1474034 -0.1473753 -0.1469122 -0.1469071 -0.1465026 ## 23457 23136 3159 79858 197335 56834 65125 ## -0.1460466 -0.1458503 -0.1453661 -0.1453564 -0.1446696 -0.1431407 -0.1424700 ## 9064 10561 6894 9353 79612 1009 118 ## -0.1419632 -0.1419189 -0.1418785 -0.1416117 -0.1414871 -0.1411882 -0.1409515 ## 311 51 115426 10902 6929 27315 283899 ## -0.1407606 -0.1405595 -0.1404169 -0.1391474 -0.1378485 -0.1376388 -0.1375334 ## 116986 7089 55968 145270 5891 427 57636 ## -0.1369290 -0.1368327 -0.1366580 -0.1365163 -0.1363543 -0.1363092 -0.1360100 ## 64089 347689 54819 54583 55871 9364 147184 ## -0.1359647 -0.1358420 -0.1353834 -0.1340605 -0.1340434 -0.1331417 -0.1327681 ## 51490 27445 10260 11011 900 55704 115196 ## -0.1324081 -0.1321598 -0.1317851 -0.1316543 -0.1308592 -0.1305784 -0.1304436 ## 57494 8826 10152 6198 83892 64221 23294 ## -0.1299672 -0.1298179 -0.1298076 -0.1294887 -0.1291402 -0.1289672 -0.1285852 ## 23294 51296 4661 4661 92558 10921 10536 ## -0.1285852 -0.1283329 -0.1281357 -0.1281357 -0.1280428 -0.1258038 -0.1256692 ## 91869 317 2934 79629 4833 23216 2210 ## -0.1256112 -0.1256095 -0.1255415 -0.1255313 -0.1248949 -0.1246227 -0.1243630 ## 5339 10902 5602 23263 10497 93349 23085 ## -0.1243179 -0.1236767 -0.1235413 -0.1234350 -0.1229931 -0.1222455 -0.1216904 ## 287 57655 2006 22905 26099 10451 57461 ## -0.1215446 -0.1214933 -0.1210547 -0.1208799 -0.1206900 -0.1205363 -0.1205247 ## 6502 79600 5209 57545 8301 3712 9489 ## -0.1200543 -0.1192673 -0.1192363 -0.1192172 -0.1191802 -0.1185624 -0.1181123 ## 6556 79068 10974 6258 83463 22876 22933 ## -0.1178447 -0.1175149 -0.1171685 -0.1169635 -0.1168536 -0.1163220 -0.1156561 ## 7249 57553 10460 1742 5939 23598 7084 ## -0.1152561 -0.1150404 -0.1137457 -0.1133740 -0.1131434 -0.1129219 -0.1127595 ## 771 987 89796 197335 57646 6867 124935 ## -0.1121337 -0.1116281 -0.1115992 -0.1111831 -0.1105608 -0.1102104 -0.1090269 ## 346171 8733 7402 140739 80152 23253 64432 ## -0.1088682 -0.1087378 -0.1087291 -0.1085317 -0.1082192 -0.1075608 -0.1074890 ## 6608 84436 347689 53407 7132 79726 6500 ## -0.1074767 -0.1071432 -0.1067727 -0.1063731 -0.1044109 -0.1039277 -0.1038658 ## 79085 64326 7994 10635 94239 7145 5298 ## -0.1034704 -0.1032697 -0.1028410 -0.1021158 -0.1018516 -0.1010673 -0.1009685 ## 22859 260425 23731 ## -0.1008330 -0.1002978 -0.1000736 4.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; "],["go-and-kegg-ptbp1-targets-09.html", "Chapter 5 GO and KEGG: PTBP1 targets 09 5.1 Load the data 5.2 Gene ontology (GO) 5.3 KEGG", " Chapter 5 GO and KEGG: PTBP1 targets 09 5.1 Load the data data_MAPP &lt;- read.table(&quot;data/inclusion_fractions_FG_PTBP1_targets_09.tsv&quot;, header = T) DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 5.2 Gene ontology (GO) 5.2.1 Prepare the gene list genes &lt;- data_MAPP %&gt;% arrange(desc(ABSDIFF)) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 ## &quot;ENSG00000163618&quot; &quot;ENSG00000115155&quot; &quot;ENSG00000070961&quot; &quot;ENSG00000007174&quot; ## gene_id5 gene_id6 ## &quot;ENSG00000137726&quot; &quot;ENSG00000139624&quot; 5.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 5.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 5.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 5.3 KEGG 5.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:many mapping between keys and columns ## Warning in bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, : ## 3.25% of input gene IDs are fail to map... head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.9126298 -0.8385180 -0.7876977 -0.7816336 -0.7703424 -0.7545117 ## [7] -0.7392774 -0.7386252 -0.7315559 -0.7304114 -0.7278021 -0.7037560 ## [13] -0.6733009 -0.6701628 -0.6653290 -0.6472132 -0.6457411 -0.6348466 ## [19] -0.6300727 -0.6296005 -0.6181530 -0.6129218 -0.6097948 -0.6010476 ## [25] -0.5931187 -0.5916966 -0.5904993 -0.5879064 -0.5606538 -0.5575119 ## [31] -0.5514768 -0.5372275 -0.5343243 -0.5196827 -0.5183596 -0.5177126 ## [37] -0.5076505 -0.5051949 -0.5033137 -0.5000163 -0.4925846 -0.4913249 ## [43] -0.4884007 -0.4858054 -0.4807160 -0.4741368 -0.4687341 -0.4659565 ## [49] -0.4624971 -0.4542531 -0.4537442 -0.4469815 -0.4460539 -0.4454511 ## [55] -0.4451903 -0.4436697 -0.4403571 -0.4311299 -0.4291453 -0.4269757 ## [61] -0.4269065 -0.4197553 -0.4188879 -0.4174422 -0.4126904 -0.4057942 ## [67] -0.4009934 -0.3999912 -0.3963633 -0.3960224 -0.3904581 -0.3901452 ## [73] -0.3865543 -0.3848030 -0.3844747 -0.3833293 -0.3821309 -0.3801281 ## [79] -0.3790270 -0.3722794 -0.3691189 -0.3642194 -0.3624454 -0.3593748 ## [85] -0.3588750 -0.3586005 -0.3545355 -0.3508964 -0.3506309 -0.3504221 ## [91] -0.3494306 -0.3491957 -0.3431746 -0.3429192 -0.3370899 -0.3364469 ## [97] -0.3349596 -0.3308899 -0.3276181 -0.3269538 -0.3267098 -0.3255545 ## [103] -0.3246836 -0.3232625 -0.3180534 -0.3148234 -0.3127597 -0.3124528 ## [109] -0.3124528 -0.3115548 -0.3068952 -0.3067734 -0.3047073 -0.3019194 ## [115] -0.3011440 -0.3009768 -0.2995976 -0.2959288 -0.2952774 -0.2933795 ## [121] -0.2910938 -0.2851542 -0.2818072 -0.2807892 -0.2804577 -0.2794122 ## [127] -0.2769029 -0.2714834 -0.2705176 -0.2699802 -0.2699676 -0.2629684 ## [133] -0.2612156 -0.2538541 -0.2524712 -0.2513457 -0.2493478 -0.2482621 ## [139] -0.2464798 -0.2457179 -0.2447349 -0.2442730 -0.2429050 -0.2406507 ## [145] -0.2393380 -0.2388961 -0.2380019 -0.2351941 -0.2270190 -0.2267695 ## [151] -0.2248951 -0.2247788 -0.2229465 -0.2217054 -0.2200261 -0.2199009 ## [157] -0.2182984 -0.2173284 -0.2154682 -0.2150387 -0.2082274 -0.2025265 ## [163] -0.2008807 -0.2008152 -0.2000145 -0.1987866 -0.1966885 -0.1963556 ## [169] -0.1955626 -0.1948027 -0.1946637 -0.1935917 -0.1935360 -0.1933085 ## [175] -0.1898200 -0.1875737 -0.1865218 -0.1848870 -0.1835184 -0.1805731 ## [181] -0.1766813 -0.1749731 -0.1734591 -0.1724504 -0.1717806 -0.1709129 ## [187] -0.1708498 -0.1706142 -0.1688073 -0.1678132 -0.1669835 -0.1667740 ## [193] -0.1655258 -0.1654724 -0.1652376 -0.1651035 -0.1636691 -0.1634691 ## [199] -0.1624315 -0.1611628 -0.1608525 -0.1581205 -0.1579830 -0.1571857 ## [205] -0.1567624 -0.1566988 -0.1555752 -0.1491239 -0.1485174 -0.1469071 ## [211] -0.1460466 -0.1458503 -0.1453661 -0.1407606 -0.1405595 -0.1396099 ## [217] -0.1369290 -0.1363543 -0.1360100 -0.1358420 -0.1340605 -0.1310301 ## [223] -0.1304436 -0.1299672 -0.1298179 -0.1294887 -0.1289672 -0.1281357 ## [229] -0.1280428 -0.1243630 -0.1243179 -0.1235413 -0.1234350 -0.1229931 ## [235] -0.1222455 -0.1216904 -0.1208799 -0.1205363 -0.1200543 -0.1192673 ## [241] -0.1192172 -0.1191802 -0.1164141 -0.1156561 -0.1152561 -0.1131434 ## [247] -0.1121337 -0.1116281 -0.1115992 -0.1102104 -0.1090269 -0.1087291 ## [253] -0.1082192 -0.1071432 -0.1067727 -0.1039281 -0.1018516 -0.1010673 ## [259] -0.1009685 -0.1008330 -0.1002529 -0.1000736 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 8618 9381 490 1770 53826 91012 94122 ## -0.9126298 -0.8385180 -0.7876977 -0.7816336 -0.7703424 -0.7545117 -0.7392774 ## 6550 90523 8470 782 3897 114904 54806 ## -0.7386252 -0.7315559 -0.7304114 -0.7278021 -0.7037560 -0.6733009 -0.6701628 ## 10396 10152 23114 3897 23114 321 10579 ## -0.6653290 -0.6472132 -0.6457411 -0.6348466 -0.6300727 -0.6296005 -0.6181530 ## 2550 7168 55683 118813 1211 8618 51135 ## -0.6129218 -0.6097948 -0.6010476 -0.5931187 -0.5916966 -0.5904993 -0.5879064 ## 322 29911 1639 23061 4205 51199 1627 ## -0.5606538 -0.5575119 -0.5514768 -0.5372275 -0.5343243 -0.5196827 -0.5183596 ## 57176 123591 23005 23048 64840 274 23136 ## -0.5177126 -0.5076505 -0.5051949 -0.5033137 -0.5000163 -0.4925846 -0.4913249 ## 50488 22864 9776 9016 1981 51614 10188 ## -0.4884007 -0.4858054 -0.4807160 -0.4741368 -0.4687341 -0.4659565 -0.4624971 ## 57142 10497 23564 93643 1211 57217 2036 ## -0.4542531 -0.4537442 -0.4469815 -0.4460539 -0.4454511 -0.4451903 -0.4436697 ## 57217 8567 26115 81502 160 7410 5158 ## -0.4403571 -0.4311299 -0.4291453 -0.4269757 -0.4269065 -0.4197553 -0.4188879 ## 2044 54899 153768 408 9612 254251 23187 ## -0.4174422 -0.4126904 -0.4057942 -0.4009934 -0.3999912 -0.3963633 -0.3960224 ## 153328 2260 5802 23552 7410 9887 80227 ## -0.3904581 -0.3901452 -0.3865543 -0.3848030 -0.3844747 -0.3833293 -0.3821309 ## 2542 57179 81502 2181 83707 5909 23335 ## -0.3801281 -0.3790270 -0.3722794 -0.3691189 -0.3642194 -0.3624454 -0.3593748 ## 79038 65243 23265 105369748 88 6676 8737 ## -0.3588750 -0.3586005 -0.3545355 -0.3508964 -0.3506309 -0.3504221 -0.3494306 ## 5291 100287616 66035 90203 7739 162 4140 ## -0.3491957 -0.3431746 -0.3429192 -0.3370899 -0.3364469 -0.3349596 -0.3308899 ## 54545 166614 51092 1841 493 9209 55768 ## -0.3276181 -0.3269538 -0.3267098 -0.3255545 -0.3246836 -0.3232625 -0.3180534 ## 8496 23041 9138 100505585 5792 80227 375790 ## -0.3148234 -0.3127597 -0.3124528 -0.3124528 -0.3115548 -0.3068952 -0.3067734 ## 1759 9901 2987 163 1729 23317 7164 ## -0.3047073 -0.3019194 -0.3011440 -0.3009768 -0.2995976 -0.2959288 -0.2952774 ## 55578 782 92558 161 2710 22839 5532 ## -0.2933795 -0.2910938 -0.2851542 -0.2818072 -0.2807892 -0.2804577 -0.2794122 ## 2146 23513 23265 6942 5863 145389 421 ## -0.2769029 -0.2714834 -0.2705176 -0.2699802 -0.2699676 -0.2629684 -0.2612156 ## 23266 30837 91012 84904 9112 84809 9223 ## -0.2538541 -0.2524712 -0.2513457 -0.2493478 -0.2482621 -0.2464798 -0.2457179 ## 90525 101929145 29109 9847 89796 81544 5358 ## -0.2447349 -0.2442730 -0.2429050 -0.2406507 -0.2393380 -0.2388961 -0.2380019 ## 10540 121227 5909 58513 26505 23059 203286 ## -0.2351941 -0.2270190 -0.2267695 -0.2248951 -0.2247788 -0.2229465 -0.2217054 ## 51195 57819 9542 23199 581 113157 23332 ## -0.2200261 -0.2199009 -0.2182984 -0.2173284 -0.2154682 -0.2150387 -0.2082274 ## 11235 23059 10540 54971 8945 3274 23028 ## -0.2025265 -0.2008807 -0.2008152 -0.2000145 -0.1987866 -0.1966885 -0.1963556 ## 123872 7375 26065 10536 6942 64221 92241 ## -0.1955626 -0.1948027 -0.1946637 -0.1935917 -0.1935360 -0.1933085 -0.1898200 ## 816 2260 83636 84259 55740 79784 81562 ## -0.1875737 -0.1865218 -0.1848870 -0.1835184 -0.1805731 -0.1766813 -0.1749731 ## 55577 92154 11060 10516 547 4967 8514 ## -0.1734591 -0.1724504 -0.1717806 -0.1709129 -0.1708498 -0.1706142 -0.1688073 ## 399818 2734 51619 51538 3429 55604 9104 ## -0.1678132 -0.1669835 -0.1667740 -0.1655258 -0.1654724 -0.1652376 -0.1651035 ## 58155 10087 56996 9727 288 25904 57666 ## -0.1636691 -0.1634691 -0.1624315 -0.1611628 -0.1608525 -0.1581205 -0.1579830 ## 8897 22885 57154 8514 6342 6251 8479 ## -0.1571857 -0.1567624 -0.1566988 -0.1555752 -0.1491239 -0.1485174 -0.1469071 ## 23457 23136 3159 311 51 23043 116986 ## -0.1460466 -0.1458503 -0.1453661 -0.1407606 -0.1405595 -0.1396099 -0.1369290 ## 5891 57636 347689 54583 134 115196 57494 ## -0.1363543 -0.1360100 -0.1358420 -0.1340605 -0.1310301 -0.1304436 -0.1299672 ## 8826 6198 64221 4661 92558 2210 5339 ## -0.1298179 -0.1294887 -0.1289672 -0.1281357 -0.1280428 -0.1243630 -0.1243179 ## 5602 23263 10497 93349 23085 22905 10451 ## -0.1235413 -0.1234350 -0.1229931 -0.1222455 -0.1216904 -0.1208799 -0.1205363 ## 6502 79600 57545 8301 29803 22933 7249 ## -0.1200543 -0.1192673 -0.1192172 -0.1191802 -0.1164141 -0.1156561 -0.1152561 ## 5939 771 987 89796 6867 124935 7402 ## -0.1131434 -0.1121337 -0.1116281 -0.1115992 -0.1102104 -0.1090269 -0.1087291 ## 80152 84436 347689 162968 94239 7145 5298 ## -0.1082192 -0.1071432 -0.1067727 -0.1039281 -0.1018516 -0.1010673 -0.1009685 ## 22859 23499 23731 ## -0.1008330 -0.1002529 -0.1000736 5.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; "],["go-and-kegg-rbfox1-targets-05.html", "Chapter 6 GO and KEGG: RBFOX1 targets 05 6.1 Load the data 6.2 Gene ontology (GO) 6.3 KEGG", " Chapter 6 GO and KEGG: RBFOX1 targets 05 6.1 Load the data data_MAPP &lt;- read.table(&quot;data/inclusion_fractions_FG_RBFOX1_targets_05.tsv&quot;, header = T) DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 6.2 Gene ontology (GO) 6.2.1 Prepare the gene list genes &lt;- data_MAPP %&gt;% arrange(desc(ABSDIFF)) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 ## &quot;ENSG00000157445&quot; &quot;ENSG00000081923&quot; &quot;ENSG00000114805&quot; &quot;ENSG00000117114&quot; ## gene_id5 gene_id6 ## &quot;ENSG00000065000&quot; &quot;ENSG00000184611&quot; 6.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 6.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 6.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 6.3 KEGG 6.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:1 mapping between keys and columns ## Warning in bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, : 2.63% of input gene ## IDs are fail to map... head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.8358725 -0.7708317 -0.7312835 -0.6673038 -0.6374273 -0.6120330 -0.5837685 -0.5625818 ## [9] -0.5498302 -0.5449858 -0.5156668 -0.5131267 -0.4974824 -0.4913183 -0.4904037 -0.4874627 ## [17] -0.4858158 -0.4720300 -0.4712907 -0.4669026 -0.4629705 -0.4629685 -0.4464172 -0.4308766 ## [25] -0.4305493 -0.4210806 -0.3956039 -0.3937624 -0.3929403 -0.3869039 -0.3866421 -0.3806583 ## [33] -0.3748361 -0.3703570 -0.3619472 -0.3590499 -0.3582381 -0.3411725 -0.3346450 -0.3318807 ## [41] -0.3121855 -0.2937947 -0.2823431 -0.2775016 -0.2760941 -0.2750906 -0.2697988 -0.2569122 ## [49] -0.2449537 -0.2428994 -0.2399435 -0.2374465 -0.2350401 -0.2350125 -0.2348441 -0.2331630 ## [57] -0.2252108 -0.2226148 -0.2190513 -0.2188537 -0.2127283 -0.2120938 -0.2090721 -0.2050971 ## [65] -0.1995887 -0.1986934 -0.1963116 -0.1953891 -0.1907279 -0.1855108 -0.1852250 -0.1802956 ## [73] -0.1790388 -0.1769819 -0.1762969 -0.1746900 -0.1733775 -0.1733665 -0.1732260 -0.1679415 ## [81] -0.1645351 -0.1580064 -0.1465838 -0.1443043 -0.1438500 -0.1429955 -0.1427919 -0.1425537 ## [89] -0.1360011 -0.1316578 -0.1308839 -0.1304457 -0.1265238 -0.1258436 -0.1252140 -0.1244610 ## [97] -0.1230552 -0.1219384 -0.1218169 -0.1186675 -0.1180657 -0.1172783 -0.1171512 -0.1159673 ## [105] -0.1117122 -0.1106982 -0.1105960 -0.1098876 -0.1088295 -0.1088234 -0.1065946 -0.1056889 ## [113] -0.1052476 -0.1052013 -0.1020050 -0.1018100 -0.1006553 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 55799 5205 23007 23266 8943 90134 57828 1936 4771 ## -0.8358725 -0.7708317 -0.7312835 -0.6673038 -0.6374273 -0.6120330 -0.5837685 -0.5625818 -0.5498302 ## 427 91050 5378 91012 92335 23301 2199 817 8567 ## -0.5449858 -0.5156668 -0.5131267 -0.4974824 -0.4913183 -0.4904037 -0.4874627 -0.4858158 -0.4720300 ## 10059 117 57568 10059 4897 8028 10129 22864 783 ## -0.4712907 -0.4669026 -0.4629705 -0.4629685 -0.4464172 -0.4308766 -0.4305493 -0.4210806 -0.3956039 ## 93664 2887 4209 4676 4345 4430 207063 9208 26260 ## -0.3937624 -0.3929403 -0.3869039 -0.3866421 -0.3806583 -0.3748361 -0.3703570 -0.3619472 -0.3590499 ## 26037 1936 8618 55605 9750 114327 1781 55605 124565 ## -0.3582381 -0.3411725 -0.3346450 -0.3318807 -0.3121855 -0.2937947 -0.2823431 -0.2775016 -0.2760941 ## 6185 7337 84326 1305 6242 9112 825 5796 84081 ## -0.2750906 -0.2697988 -0.2569122 -0.2449537 -0.2428994 -0.2399435 -0.2374465 -0.2350401 -0.2350125 ## 114883 6749 10525 51026 114883 55605 4036 57655 8882 ## -0.2348441 -0.2331630 -0.2252108 -0.2226148 -0.2190513 -0.2188537 -0.2127283 -0.2120938 -0.2090721 ## 10561 5923 79701 726 220869 83787 85397 323 4212 ## -0.2050971 -0.1995887 -0.1986934 -0.1963116 -0.1953891 -0.1907279 -0.1855108 -0.1852250 -0.1802956 ## 287 130340 134429 4152 8502 26750 8853 1974 8496 ## -0.1790388 -0.1769819 -0.1762969 -0.1746900 -0.1733775 -0.1733665 -0.1732260 -0.1679415 -0.1645351 ## 8073 101927314 1759 25854 8555 51304 124540 10755 55975 ## -0.1580064 -0.1465838 -0.1443043 -0.1438500 -0.1429955 -0.1427919 -0.1425537 -0.1360011 -0.1316578 ## 57153 4139 10175 25854 283130 113402 22872 79621 5504 ## -0.1308839 -0.1304457 -0.1265238 -0.1258436 -0.1252140 -0.1244610 -0.1230552 -0.1219384 -0.1218169 ## 146664 23348 55638 6597 5747 54960 9819 26011 9941 ## -0.1186675 -0.1180657 -0.1172783 -0.1171512 -0.1159673 -0.1117122 -0.1106982 -0.1105960 -0.1098876 ## 23175 4800 8611 26269 22978 55743 8573 8559 285761 ## -0.1088295 -0.1088234 -0.1065946 -0.1056889 -0.1052476 -0.1052013 -0.1020050 -0.1018100 -0.1006553 6.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["go-and-kegg-rbfox1-targets-09.html", "Chapter 7 GO and KEGG: RBFOX1 targets 09 7.1 Load the data 7.2 Gene ontology (GO) 7.3 KEGG", " Chapter 7 GO and KEGG: RBFOX1 targets 09 7.1 Load the data data_MAPP &lt;- read.table(&quot;data/inclusion_fractions_FG_RBFOX1_targets_09.tsv&quot;, header = T) DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 7.2 Gene ontology (GO) 7.2.1 Prepare the gene list genes &lt;- data_MAPP %&gt;% arrange(desc(ABSDIFF)) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 gene_id5 ## &quot;ENSG00000157445&quot; &quot;ENSG00000007047&quot; &quot;ENSG00000081923&quot; &quot;ENSG00000124313&quot; &quot;ENSG00000197959&quot; ## gene_id6 ## &quot;ENSG00000117114&quot; 7.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 7.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 7.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 7.3 KEGG 7.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:1 mapping between keys and columns ## Warning in bitr(data_MAPP$gene_id, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, : 3.06% of input gene ## IDs are fail to map... head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.8358725 -0.8257557 -0.7708317 -0.7253903 -0.6807944 -0.6673038 -0.6374273 -0.6063017 ## [9] -0.5928132 -0.5837685 -0.5498302 -0.5156668 -0.5131267 -0.4913183 -0.4904037 -0.4874627 ## [17] -0.4858158 -0.4778612 -0.4712907 -0.4629705 -0.4629685 -0.4308766 -0.4210806 -0.3956039 ## [25] -0.3937732 -0.3937624 -0.3866421 -0.3806583 -0.3748361 -0.3734401 -0.3619472 -0.3590499 ## [33] -0.3346450 -0.3318807 -0.3283974 -0.3017486 -0.2937947 -0.2823431 -0.2775016 -0.2760941 ## [41] -0.2750906 -0.2697988 -0.2569122 -0.2449537 -0.2437877 -0.2399435 -0.2374465 -0.2350401 ## [49] -0.2350125 -0.2348441 -0.2331630 -0.2252108 -0.2226148 -0.2190513 -0.2188537 -0.2160939 ## [57] -0.2137278 -0.2090721 -0.2050971 -0.1995887 -0.1963116 -0.1953891 -0.1946038 -0.1907279 ## [65] -0.1852250 -0.1802956 -0.1762969 -0.1746900 -0.1733775 -0.1733665 -0.1732260 -0.1729623 ## [73] -0.1708320 -0.1580064 -0.1465838 -0.1460860 -0.1443043 -0.1429955 -0.1360011 -0.1316578 ## [81] -0.1308839 -0.1265238 -0.1252140 -0.1230552 -0.1219384 -0.1186675 -0.1180657 -0.1179384 ## [89] -0.1172783 -0.1171512 -0.1164545 -0.1106982 -0.1088295 -0.1088234 -0.1056889 -0.1052476 ## [97] -0.1052013 -0.1020050 -0.1018100 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 55799 57787 5205 23096 26052 23266 8943 8541 1803 ## -0.8358725 -0.8257557 -0.7708317 -0.7253903 -0.6807944 -0.6673038 -0.6374273 -0.6063017 -0.5928132 ## 57828 4771 91050 5378 92335 23301 2199 817 157574 ## -0.5837685 -0.5498302 -0.5156668 -0.5131267 -0.4913183 -0.4904037 -0.4874627 -0.4858158 -0.4778612 ## 10059 57568 10059 8028 22864 783 10892 93664 4676 ## -0.4712907 -0.4629705 -0.4629685 -0.4308766 -0.4210806 -0.3956039 -0.3937732 -0.3937624 -0.3866421 ## 4345 4430 6334 9208 26260 8618 55605 283234 54828 ## -0.3806583 -0.3748361 -0.3734401 -0.3619472 -0.3590499 -0.3346450 -0.3318807 -0.3283974 -0.3017486 ## 114327 1781 55605 124565 6185 7337 84326 1305 56947 ## -0.2937947 -0.2823431 -0.2775016 -0.2760941 -0.2750906 -0.2697988 -0.2569122 -0.2449537 -0.2437877 ## 9112 825 5796 84081 114883 6749 10525 51026 114883 ## -0.2399435 -0.2374465 -0.2350401 -0.2350125 -0.2348441 -0.2331630 -0.2252108 -0.2226148 -0.2190513 ## 55605 445815 79772 8882 10561 5923 726 220869 10675 ## -0.2188537 -0.2160939 -0.2137278 -0.2090721 -0.2050971 -0.1995887 -0.1963116 -0.1953891 -0.1946038 ## 83787 323 4212 134429 4152 8502 26750 8853 130733 ## -0.1907279 -0.1852250 -0.1802956 -0.1762969 -0.1746900 -0.1733775 -0.1733665 -0.1732260 -0.1729623 ## 65258 8073 101927314 4926 1759 8555 10755 55975 57153 ## -0.1708320 -0.1580064 -0.1465838 -0.1460860 -0.1443043 -0.1429955 -0.1360011 -0.1316578 -0.1308839 ## 10175 283130 22872 79621 146664 23348 23143 55638 6597 ## -0.1265238 -0.1252140 -0.1230552 -0.1219384 -0.1186675 -0.1180657 -0.1179384 -0.1172783 -0.1171512 ## 9873 9819 23175 4800 26269 22978 55743 8573 8559 ## -0.1164545 -0.1106982 -0.1088295 -0.1088234 -0.1056889 -0.1052476 -0.1052013 -0.1020050 -0.1018100 7.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]

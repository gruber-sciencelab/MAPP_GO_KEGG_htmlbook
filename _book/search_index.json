[["index.html", "GO and KEGG analysis for MAPP paper Chapter 1 Prerequisites 1.1 Libraries 1.2 Options 1.3 Universe set of genes 1.4 Render the book 1.5 Session info", " GO and KEGG analysis for MAPP paper Ian U. Kouzel 2022-08-12 Chapter 1 Prerequisites 1.1 Libraries library(tidyverse) library(clusterProfiler) library(pathview) library(enrichplot) library(org.Hs.eg.db) library(readr) library(DT) 1.2 Options # GO analysis minGSSize &lt;- 10 # minimal size of genes annotated by Ontology term for testing organismDB &lt;- &quot;org.Hs.eg.db&quot; # human DB pvalueCutoff = 0.1 # p-value cutoff showCategory = 10 # number of GOs to plot genes_padj_cutoff = 0.1 # padjusted cut of for genes that are different # between control and cancer conditions 1.3 Universe set of genes 1.3.1 GO (ENSEMBL) universe &lt;- read.table(&quot;inclusion_tables/cassette_exons_universe_table.tsv&quot;, header = T) %&gt;% dplyr::select(gene_id) %&gt;% unlist() universe &lt;- unique(unlist(strsplit(universe, &quot;,&quot;))) head(universe, 10) ## [1] &quot;ENSG00000174371&quot; &quot;ENSG00000117009&quot; &quot;ENSG00000284770&quot; &quot;ENSG00000285053&quot; &quot;ENSG00000143774&quot; &quot;ENSG00000143801&quot; &quot;ENSG00000143353&quot; ## [8] &quot;ENSG00000117691&quot; &quot;ENSG00000117625&quot; &quot;ENSG00000143469&quot; length(universe) ## [1] 10273 1.3.2 KEGG (ENTREZ) ENTREZ_universe &lt;- read.table(&quot;inclusion_tables/cassette_exons_universe_table.tsv&quot;, header = T) %&gt;% dplyr::select(gene_id) %&gt;% unlist() ENTREZ_universe &lt;- unique(unlist(strsplit(ENTREZ_universe, &quot;,&quot;))) ENTREZ_universe &lt;- bitr(ENTREZ_universe, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% dplyr::select(ENTREZID) %&gt;% unlist() ## &#39;select()&#39; returned 1:many mapping between keys and columns ## Warning in bitr(ENTREZ_universe, fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, : 0.91% of input gene IDs are fail to map... ENTREZ_universe &lt;- unique(unlist(strsplit(ENTREZ_universe, &quot;,&quot;))) head(ENTREZ_universe) ## [1] &quot;9156&quot; &quot;8564&quot; &quot;6905&quot; &quot;2987&quot; &quot;5664&quot; &quot;127018&quot; length(ENTREZ_universe) ## [1] 10220 1.4 Render the book bookdown::render_book(&quot;index.Rmd&quot;, &quot;bookdown::gitbook&quot;) install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) 1.5 Session info sessionInfo() ## R version 4.2.0 (2022-04-22) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Monterey 12.0.1 ## ## Matrix products: default ## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats4 stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] DT_0.23 org.Hs.eg.db_3.15.0 AnnotationDbi_1.58.0 IRanges_2.30.0 S4Vectors_0.34.0 Biobase_2.56.0 ## [7] BiocGenerics_0.42.0 enrichplot_1.16.0 pathview_1.36.0 clusterProfiler_4.4.1 matrixTests_0.1.9.1 forcats_0.5.1 ## [13] stringr_1.4.0 dplyr_1.0.9 purrr_0.3.4 readr_2.1.2 tidyr_1.2.0 tibble_3.1.7 ## [19] ggplot2_3.3.6 tidyverse_1.3.1 ## ## loaded via a namespace (and not attached): ## [1] readxl_1.4.0 shadowtext_0.1.2 backports_1.4.1 fastmatch_1.1-3 plyr_1.8.7 ## [6] igraph_1.3.1 lazyeval_0.2.2 splines_4.2.0 BiocParallel_1.30.0 crosstalk_1.2.0 ## [11] GenomeInfoDb_1.32.1 digest_0.6.29 yulab.utils_0.0.4 htmltools_0.5.2 GOSemSim_2.22.0 ## [16] viridis_0.6.2 GO.db_3.15.0 fansi_1.0.3 magrittr_2.0.3 memoise_2.0.1 ## [21] tzdb_0.3.0 Biostrings_2.64.0 graphlayouts_0.8.0 modelr_0.1.8 matrixStats_0.62.0 ## [26] colorspace_2.0-3 blob_1.2.3 rvest_1.0.2 ggrepel_0.9.1 haven_2.5.0 ## [31] xfun_0.31 crayon_1.5.1 RCurl_1.98-1.6 jsonlite_1.8.0 graph_1.74.0 ## [36] scatterpie_0.1.7 ape_5.6-2 glue_1.6.2 polyclip_1.10-0 gtable_0.3.0 ## [41] zlibbioc_1.42.0 XVector_0.36.0 Rgraphviz_2.40.0 scales_1.2.0 DOSE_3.22.0 ## [46] DBI_1.1.2 Rcpp_1.0.8.3 viridisLite_0.4.0 gridGraphics_0.5-1 tidytree_0.3.9 ## [51] bit_4.0.4 htmlwidgets_1.5.4 httr_1.4.3 fgsea_1.22.0 RColorBrewer_1.1-3 ## [56] ellipsis_0.3.2 XML_3.99-0.9 pkgconfig_2.0.3 farver_2.1.0 sass_0.4.1 ## [61] dbplyr_2.1.1 utf8_1.2.2 labeling_0.4.2 ggplotify_0.1.0 tidyselect_1.1.2 ## [66] rlang_1.0.4 reshape2_1.4.4 munsell_0.5.0 cellranger_1.1.0 tools_4.2.0 ## [71] cachem_1.0.6 downloader_0.4 cli_3.3.0 generics_0.1.2 RSQLite_2.2.14 ## [76] broom_0.8.0 evaluate_0.15 fastmap_1.1.0 yaml_2.3.5 ggtree_3.4.0 ## [81] knitr_1.39 bit64_4.0.5 fs_1.5.2 tidygraph_1.2.1 KEGGREST_1.36.0 ## [86] ggraph_2.0.5 nlme_3.1-157 KEGGgraph_1.56.0 aplot_0.1.4 DO.db_2.9 ## [91] xml2_1.3.3 compiler_4.2.0 rstudioapi_0.13 png_0.1-7 reprex_2.0.1 ## [96] treeio_1.20.0 tweenr_1.0.2 bslib_0.3.1 stringi_1.7.6 highr_0.9 ## [101] lattice_0.20-45 Matrix_1.4-1 vctrs_0.4.1 pillar_1.7.0 lifecycle_1.0.1 ## [106] jquerylib_0.1.4 data.table_1.14.2 bitops_1.0-7 patchwork_1.1.1 qvalue_2.28.0 ## [111] R6_2.5.1 bookdown_0.27 gridExtra_2.3 MASS_7.3-57 assertthat_0.2.1 ## [116] withr_2.5.0 GenomeInfoDbData_1.2.8 parallel_4.2.0 hms_1.1.1 grid_4.2.0 ## [121] ggfun_0.0.6 rmarkdown_2.14 ggforce_0.3.3 lubridate_1.8.0 "],["go-and-kegg-common-targets-06.html", "Chapter 2 GO and KEGG: common targets 06 2.1 Load the data 2.2 Gene ontology (GO) 2.3 KEGG", " Chapter 2 GO and KEGG: common targets 06 2.1 Load the data data_MAPP &lt;- read.table(&quot;inclusion_tables/0.6/common_targets.tsv&quot;, header = T) # select control and cancer columns library(tidyverse) CTRL &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CONTROL_&quot;, names(.))) CANCER &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CANCER_&quot;, names(.))) # use row_t_welch instead of usual t.test function since t.test produces # errors in some cases: t.test error: data are essentially constant # NAs are assigned for problematic cases # https://stats.stackexchange.com/questions/499634/t-test-error-data-are-essentially-constant/499637 library(matrixTests) data_MAPP &lt;- data_MAPP %&gt;% mutate(padj = p.adjust(row_t_welch(CTRL, CANCER)$pvalue, method = &quot;BH&quot;, n=nrow(data_MAPP))) ## Warning: row_t_welch: 65 of the rows were essentially constant. ## First occurrence at row 34 # data_MAPP &lt;- data_MAPP %&gt;% # mutate(pval=row_t_welch(CTRL, CANCER)$pvalue) sum(is.na(data_MAPP$padj)) ## [1] 65 DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 2.2 Gene ontology (GO) 2.2.1 Prepare the gene list # select genes from data_MAPP table based on padj values # threshold is set in index.Rmd: genes_padj_cutoff genes &lt;- na.omit(data_MAPP) %&gt;% arrange(desc(ABSDIFF)) %&gt;% filter(padj &lt; genes_padj_cutoff) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 gene_id5 gene_id6 ## &quot;ENSG00000136699&quot; &quot;ENSG00000136153&quot; &quot;ENSG00000007047&quot; &quot;ENSG00000070961&quot; &quot;ENSG00000137726&quot; &quot;ENSG00000172292&quot; 2.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 2.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 2.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 2.3 KEGG 2.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:1 mapping between keys and columns ## Warning in bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), : 1.28% of input gene IDs are fail to map... head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.8979957360 -0.8584353547 -0.8257323117 -0.7876479961 -0.7707704024 -0.7520255373 -0.7313491711 -0.7283427350 -0.7255878978 ## [10] -0.6812689861 -0.6761845435 -0.6457757451 0.6131462418 -0.6126834170 -0.6059904981 -0.5835027874 0.5826520665 -0.5779614938 ## [19] -0.5731150152 -0.5039827010 -0.4949639671 -0.4780925852 -0.4673897228 0.4601035870 -0.4476402302 -0.4461977900 -0.4435530520 ## [28] -0.4326941390 -0.4292709048 -0.4214836971 0.4212018927 -0.4207321022 -0.4128495278 -0.4079200779 -0.3993679992 -0.3990899594 ## [37] -0.3940557482 -0.3936374396 -0.3917491879 -0.3759729828 -0.3746133848 -0.3740641877 -0.3624652536 -0.3590452996 -0.3346734528 ## [46] 0.3303761298 -0.3246021231 -0.3218975259 -0.3177806050 -0.3166976440 -0.3164674623 -0.3064956280 0.3054761572 -0.2993130088 ## [55] -0.2982095154 -0.2961029474 0.2911460988 -0.2897872002 0.2866329682 0.2828069050 -0.2802366615 -0.2796783989 -0.2773482221 ## [64] -0.2752379288 -0.2714972937 -0.2694050827 -0.2623990233 -0.2614033917 -0.2541493969 -0.2489342648 -0.2405546435 0.2346973949 ## [73] -0.2330956201 -0.2330442045 -0.2235605792 -0.2199805472 -0.2189998265 -0.2183150011 0.2181638192 -0.2177805915 -0.2161346331 ## [82] -0.2149441538 -0.2137478381 -0.2082725497 -0.2082416337 0.2068000831 -0.2064822542 0.2021587608 -0.1966051421 0.1945417443 ## [91] 0.1931904684 0.1931255613 -0.1783068393 -0.1766775613 0.1765509237 -0.1751534582 -0.1732551019 0.1718826320 -0.1718531956 ## [100] -0.1709080057 -0.1705078778 -0.1689292006 -0.1648515758 -0.1635630605 -0.1635210081 -0.1610984290 -0.1555800453 -0.1528324557 ## [109] -0.1443977455 0.1424137390 -0.1394626681 -0.1369444408 -0.1308699437 -0.1251072462 -0.1165410320 -0.1157577022 -0.1098105746 ## [118] -0.1085861913 -0.1084035989 -0.1074500481 -0.1071484814 -0.1053005124 0.1020073403 -0.1008724841 -0.0996860714 0.0989993343 ## [127] 0.0930629753 -0.0921203587 -0.0859871735 -0.0851788674 0.0847634790 -0.0795743916 -0.0784768772 -0.0729334772 -0.0694070759 ## [136] 0.0662037416 -0.0654547864 -0.0634562256 -0.0625232801 0.0615012419 -0.0613524086 -0.0610086036 -0.0602049942 0.0569950343 ## [145] -0.0566128969 0.0558449497 0.0556274035 -0.0512795212 -0.0486206120 -0.0482100654 -0.0455434529 0.0422874365 0.0408642398 ## [154] -0.0393809472 0.0391562069 -0.0389413320 -0.0388612277 0.0372750994 -0.0345159444 -0.0332844259 -0.0316590939 -0.0297987331 ## [163] -0.0268358961 0.0241351292 0.0235617299 -0.0226489685 -0.0208535623 -0.0188973975 0.0158897525 -0.0155968569 -0.0150684310 ## [172] -0.0147565153 0.0085076823 -0.0078767310 -0.0065933510 -0.0042393945 -0.0041564412 0.0039131408 -0.0034842387 -0.0034348407 ## [181] 0.0026328364 -0.0015689498 -0.0013973071 0.0010281511 0.0006295817 -0.0004179173 0.0003624584 0.0000000000 0.0000000000 ## [190] 0.0000000000 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 55627 4008 57787 490 53826 253782 90523 782 23096 ## -0.8979957360 -0.8584353547 -0.8257323117 -0.7876479961 -0.7707704024 -0.7520255373 -0.7313491711 -0.7283427350 -0.7255878978 ## 26052 28964 23114 222658 2550 8541 57828 23092 54478 ## -0.6812689861 -0.6761845435 -0.6457757451 0.6131462418 -0.6126834170 -0.6059904981 -0.5835027874 0.5826520665 -0.5779614938 ## 22885 23048 4628 157574 1981 23048 23229 57217 2036 ## -0.5731150152 -0.5039827010 -0.4949639671 -0.4780925852 -0.4673897228 0.4601035870 -0.4476402302 -0.4461977900 -0.4435530520 ## 84892 26115 22864 57179 23095 92840 490 2036 84698 ## -0.4326941390 -0.4292709048 -0.4214836971 0.4212018927 -0.4207321022 -0.4128495278 -0.4079200779 -0.3993679992 -0.3990899594 ## 55738 10892 800 6334 4430 9209 5909 26260 1305 ## -0.3940557482 -0.3936374396 -0.3917491879 -0.3759729828 -0.3746133848 -0.3740641877 -0.3624652536 -0.3590452996 -0.3346734528 ## 23048 493 53826 51533 126626 3796 375790 8496 1729 ## 0.3303761298 -0.3246021231 -0.3218975259 -0.3177806050 -0.3166976440 -0.3164674623 -0.3064956280 0.3054761572 -0.2993130088 ## 57646 23317 23092 776 8932 9815 9659 57706 55605 ## -0.2982095154 -0.2961029474 0.2911460988 -0.2897872002 0.2866329682 0.2828069050 -0.2802366615 -0.2796783989 -0.2773482221 ## 6185 23513 55627 54413 55054 818 5977 9847 351 ## -0.2752379288 -0.2714972937 -0.2694050827 -0.2623990233 -0.2614033917 -0.2541493969 -0.2489342648 -0.2405546435 0.2346973949 ## 6749 5209 58513 51195 55605 114883 79925 23199 445815 ## -0.2330956201 -0.2330442045 -0.2235605792 -0.2199805472 -0.2189998265 -0.2183150011 0.2181638192 -0.2177805915 -0.2161346331 ## 204 79772 55614 115704 283643 55605 23224 3274 168667 ## -0.2149441538 -0.2137478381 -0.2082725497 -0.2082416337 0.2068000831 -0.2064822542 0.2021587608 -0.1966051421 0.1945417443 ## 162655 4140 8751 79784 10425 81562 26750 5935 29959 ## 0.1931904684 0.1931255613 -0.1783068393 -0.1766775613 0.1765509237 -0.1751534582 -0.1732551019 0.1718826320 -0.1718531956 ## 65258 547 23559 9650 10087 58155 9727 8514 23139 ## -0.1709080057 -0.1705078778 -0.1689292006 -0.1648515758 -0.1635630605 -0.1635210081 -0.1610984290 -0.1555800453 -0.1528324557 ## 8751 3836 10902 116986 57153 152926 9873 25829 84167 ## -0.1443977455 0.1424137390 -0.1394626681 -0.1369444408 -0.1308699437 -0.1251072462 -0.1165410320 -0.1157577022 -0.1098105746 ## 7402 54808 6608 131965 22978 64963 260425 23559 5977 ## -0.1085861913 -0.1084035989 -0.1074500481 -0.1071484814 -0.1053005124 0.1020073403 -0.1008724841 -0.0996860714 0.0989993343 ## 80017 6257 10580 85021 2635 22902 51642 6229 9322 ## 0.0930629753 -0.0921203587 -0.0859871735 -0.0851788674 0.0847634790 -0.0795743916 -0.0784768772 -0.0729334772 -0.0694070759 ## 58475 65009 6714 54840 11275 10580 91039 113451 79258 ## 0.0662037416 -0.0654547864 -0.0634562256 -0.0625232801 0.0615012419 -0.0613524086 -0.0610086036 -0.0602049942 0.0569950343 ## 3959 5935 23352 23022 56853 9112 8725 90423 521 ## -0.0566128969 0.0558449497 0.0556274035 -0.0512795212 -0.0486206120 -0.0482100654 -0.0455434529 0.0422874365 0.0408642398 ## 1741 9832 54443 10313 90523 22978 26750 10497 5209 ## -0.0393809472 0.0391562069 -0.0389413320 -0.0388612277 0.0372750994 -0.0345159444 -0.0332844259 -0.0316590939 -0.0297987331 ## 5764 140739 4137 10212 23365 10212 3959 11170 1729 ## -0.0268358961 0.0241351292 0.0235617299 -0.0226489685 -0.0208535623 -0.0188973975 0.0158897525 -0.0155968569 -0.0150684310 ## 3778 10580 53826 10898 154215 818 9832 6709 6229 ## -0.0147565153 0.0085076823 -0.0078767310 -0.0065933510 -0.0042393945 -0.0041564412 0.0039131408 -0.0034842387 -0.0034348407 ## 57828 57217 3778 55605 113451 3778 10313 91039 23022 ## 0.0026328364 -0.0015689498 -0.0013973071 0.0010281511 0.0006295817 -0.0004179173 0.0003624584 0.0000000000 0.0000000000 ## 23229 ## 0.0000000000 2.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["go-and-kegg-common-targets-09.html", "Chapter 3 GO and KEGG: common targets 09 3.1 Load the data 3.2 Gene ontology (GO) 3.3 KEGG", " Chapter 3 GO and KEGG: common targets 09 3.1 Load the data data_MAPP &lt;- read.table(&quot;inclusion_tables/0.9/common_targets.tsv&quot;, header = T) # select control and cancer columns library(tidyverse) CTRL &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CONTROL_&quot;, names(.))) CANCER &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CANCER_&quot;, names(.))) # use row_t_welch instead of usual t.test function since t.test produces # errors in some cases: t.test error: data are essentially constant # NAs are assigned for problematic cases # https://stats.stackexchange.com/questions/499634/t-test-error-data-are-essentially-constant/499637 library(matrixTests) data_MAPP &lt;- data_MAPP %&gt;% mutate(padj = p.adjust(row_t_welch(CTRL, CANCER)$pvalue, method = &quot;BH&quot;, n=nrow(data_MAPP))) ## Warning: row_t_welch: 31 of the rows were essentially constant. ## First occurrence at row 24 # data_MAPP &lt;- data_MAPP %&gt;% # mutate(pval=row_t_welch(CTRL, CANCER)$pvalue) sum(is.na(data_MAPP$padj)) ## [1] 31 DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 3.2 Gene ontology (GO) 3.2.1 Prepare the gene list # select genes from data_MAPP table based on padj values # threshold is set in index.Rmd: genes_padj_cutoff genes &lt;- na.omit(data_MAPP) %&gt;% arrange(desc(ABSDIFF)) %&gt;% filter(padj &lt; genes_padj_cutoff) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 gene_id5 gene_id6 ## &quot;ENSG00000136153&quot; &quot;ENSG00000007047&quot; &quot;ENSG00000070961&quot; &quot;ENSG00000137726&quot; &quot;ENSG00000172292&quot; &quot;ENSG00000146147&quot; 3.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 3.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 3.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; 3.3 KEGG 3.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:1 mapping between keys and columns ## Warning in bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), : 2.22% of input gene IDs are fail to map... head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.8584353547 -0.8257323117 -0.7876479961 -0.7707704024 -0.7520255373 -0.7313491711 -0.7283427350 -0.6761845435 -0.6457757451 ## [10] -0.6126834170 -0.5779614938 -0.5039827010 -0.4780925852 -0.4673897228 -0.4435530520 -0.4292709048 -0.4214836971 -0.4207321022 ## [19] -0.4128495278 -0.4079200779 -0.3993679992 -0.3936374396 -0.3917491879 -0.3759729828 -0.3624652536 -0.3590452996 0.3303761298 ## [28] -0.3246021231 -0.3218975259 0.3054761572 -0.2982095154 -0.2961029474 0.2911460988 -0.2802366615 -0.2796783989 -0.2773482221 ## [37] -0.2752379288 -0.2714972937 -0.2694050827 -0.2623990233 -0.2541493969 -0.2489342648 -0.2405546435 -0.2189998265 0.2181638192 ## [46] -0.2177805915 -0.2082725497 -0.2070688578 -0.2064822542 0.2021587608 -0.1970245440 -0.1966051421 -0.1783068393 -0.1766775613 ## [55] 0.1765509237 -0.1732551019 -0.1648515758 -0.1635630605 -0.1635210081 -0.1555800453 -0.1532299449 -0.1528324557 0.1528307243 ## [64] -0.1443977455 -0.1394626681 -0.1369444408 -0.1308699437 -0.1251072462 -0.1157577022 -0.1140257975 -0.1085861913 -0.1084035989 ## [73] -0.1071484814 -0.1011045089 0.0930629753 -0.0921203587 -0.0851788674 -0.0718879304 -0.0654547864 -0.0634562256 -0.0613524086 ## [82] -0.0602049942 -0.0601736573 0.0556274035 -0.0512795212 -0.0486206120 -0.0482100654 -0.0393809472 0.0391562069 -0.0388612277 ## [91] -0.0335540588 -0.0332844259 -0.0316590939 0.0235617299 -0.0208535623 -0.0155968569 0.0085076823 -0.0078767310 -0.0051469196 ## [100] 0.0010281511 0.0006295817 0.0003624584 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 4008 57787 490 53826 253782 90523 782 28964 23114 ## -0.8584353547 -0.8257323117 -0.7876479961 -0.7707704024 -0.7520255373 -0.7313491711 -0.7283427350 -0.6761845435 -0.6457757451 ## 2550 54478 23048 157574 1981 2036 26115 22864 23095 ## -0.6126834170 -0.5779614938 -0.5039827010 -0.4780925852 -0.4673897228 -0.4435530520 -0.4292709048 -0.4214836971 -0.4207321022 ## 92840 490 2036 10892 800 6334 5909 26260 23048 ## -0.4128495278 -0.4079200779 -0.3993679992 -0.3936374396 -0.3917491879 -0.3759729828 -0.3624652536 -0.3590452996 0.3303761298 ## 493 53826 8496 57646 23317 23092 9659 57706 55605 ## -0.3246021231 -0.3218975259 0.3054761572 -0.2982095154 -0.2961029474 0.2911460988 -0.2802366615 -0.2796783989 -0.2773482221 ## 6185 23513 55627 54413 818 5977 9847 55605 79925 ## -0.2752379288 -0.2714972937 -0.2694050827 -0.2623990233 -0.2541493969 -0.2489342648 -0.2405546435 -0.2189998265 0.2181638192 ## 23199 55614 288 55605 23224 6249 3274 8751 79784 ## -0.2177805915 -0.2082725497 -0.2070688578 -0.2064822542 0.2021587608 -0.1970245440 -0.1966051421 -0.1783068393 -0.1766775613 ## 10425 26750 9650 10087 58155 8514 54462 23139 91664 ## 0.1765509237 -0.1732551019 -0.1648515758 -0.1635630605 -0.1635210081 -0.1555800453 -0.1532299449 -0.1528324557 0.1528307243 ## 8751 10902 116986 57153 152926 25829 2801 7402 54808 ## -0.1443977455 -0.1394626681 -0.1369444408 -0.1308699437 -0.1251072462 -0.1157577022 -0.1140257975 -0.1085861913 -0.1084035989 ## 131965 54462 80017 6257 85021 8502 65009 6714 10580 ## -0.1071484814 -0.1011045089 0.0930629753 -0.0921203587 -0.0851788674 -0.0718879304 -0.0654547864 -0.0634562256 -0.0613524086 ## 113451 10723 23352 23022 56853 9112 1741 9832 10313 ## -0.0602049942 -0.0601736573 0.0556274035 -0.0512795212 -0.0486206120 -0.0482100654 -0.0393809472 0.0391562069 -0.0388612277 ## 3908 26750 10497 4137 23365 11170 10580 53826 94097 ## -0.0335540588 -0.0332844259 -0.0316590939 0.0235617299 -0.0208535623 -0.0155968569 0.0085076823 -0.0078767310 -0.0051469196 ## 55605 113451 10313 ## 0.0010281511 0.0006295817 0.0003624584 3.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["go-and-kegg-ptbp1-targets-06.html", "Chapter 4 GO and KEGG: PTBP1 targets 06 4.1 Load the data 4.2 Gene ontology (GO) 4.3 KEGG", " Chapter 4 GO and KEGG: PTBP1 targets 06 4.1 Load the data data_MAPP &lt;- read.table(&quot;inclusion_tables/0.6/ptbp1_exclusive_targets.tsv&quot;, header = T) # select control and cancer columns library(tidyverse) CTRL &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CONTROL_&quot;, names(.))) CANCER &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CANCER_&quot;, names(.))) # use row_t_welch instead of usual t.test function since t.test produces # errors in some cases: t.test error: data are essentially constant # NAs are assigned for problematic cases # https://stats.stackexchange.com/questions/499634/t-test-error-data-are-essentially-constant/499637 library(matrixTests) data_MAPP &lt;- data_MAPP %&gt;% mutate(padj = p.adjust(row_t_welch(CTRL, CANCER)$pvalue, method = &quot;BH&quot;, n=nrow(data_MAPP))) ## Warning: row_t_welch: 143 of the rows were essentially constant. ## First occurrence at row 43 # data_MAPP &lt;- data_MAPP %&gt;% # mutate(pval=row_t_welch(CTRL, CANCER)$pvalue) sum(is.na(data_MAPP$padj)) ## [1] 143 DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 4.2 Gene ontology (GO) 4.2.1 Prepare the gene list # select genes from data_MAPP table based on padj values # threshold is set in index.Rmd: genes_padj_cutoff genes &lt;- na.omit(data_MAPP) %&gt;% arrange(desc(ABSDIFF)) %&gt;% filter(padj &lt; genes_padj_cutoff) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 gene_id5 gene_id6 ## &quot;ENSG00000066230&quot; &quot;ENSG00000108018&quot; &quot;ENSG00000198910&quot; &quot;ENSG00000175182&quot; &quot;ENSG00000160410&quot; &quot;ENSG00000198910&quot; 4.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 4.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 4.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 4.3 KEGG 4.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:1 mapping between keys and columns ## Warning in bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), : 0.65% of input gene IDs are fail to map... head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.7386234447 0.7234788392 -0.7038045357 -0.6767915011 0.6375013660 -0.6348159210 -0.6326628316 -0.6183222312 0.6174028876 ## [10] -0.6140461704 -0.6090158816 -0.6061716878 -0.6056684642 -0.5904575645 -0.5516013241 -0.5371580583 -0.5060305047 -0.4982807580 ## [19] -0.4807004864 0.4793950287 -0.4597016162 -0.4537595538 -0.4170725114 -0.4125588465 -0.4023926271 0.4023150393 -0.4011637408 ## [28] -0.4008816599 -0.4000936554 -0.3961706940 -0.3846735935 0.3804743706 -0.3801249848 -0.3787195015 0.3732326499 -0.3647345621 ## [37] -0.3545908955 -0.3484162073 -0.3350696756 0.3340303944 -0.3302687735 -0.3128791385 -0.3127745804 -0.3089303409 -0.3011135743 ## [46] -0.2851575359 0.2805972602 -0.2796040305 -0.2781290345 -0.2737303878 -0.2705194645 -0.2661378464 -0.2627351309 0.2564752438 ## [55] -0.2521550892 0.2510039064 0.2499223522 -0.2456948766 0.2428143831 -0.2387547898 -0.2352394178 -0.2248009201 -0.2227803174 ## [64] -0.2214999913 -0.2153954570 -0.2137842988 -0.2134123229 0.2072078233 -0.2027331300 -0.2023366651 -0.2008920065 -0.2007350915 ## [73] 0.1981858275 -0.1956600082 -0.1946907931 -0.1936560438 0.1918771838 -0.1907448643 0.1904533776 0.1903463417 0.1834421396 ## [82] -0.1815393577 -0.1730988832 -0.1681718254 -0.1676786698 -0.1654800446 -0.1650522233 -0.1605138528 0.1593921290 0.1584392564 ## [91] -0.1582708466 0.1561459358 -0.1553110821 0.1524532329 0.1511253529 0.1508286268 -0.1467825838 -0.1454036449 -0.1453129239 ## [100] 0.1431509296 -0.1405528325 -0.1390944514 -0.1345836652 0.1344607384 0.1337166473 0.1325263215 -0.1320972171 -0.1268212659 ## [109] -0.1255175715 -0.1234657988 -0.1234367491 0.1228017521 0.1224734400 -0.1183739153 0.1165388302 0.1163248259 -0.1150050172 ## [118] -0.1136706999 -0.1133982194 0.1095649637 -0.1092203820 -0.1090249174 0.1081349218 -0.1078565684 0.1021686602 -0.1021405510 ## [127] -0.1017850335 -0.1011212729 -0.1008642737 -0.1005088073 0.0986096766 -0.0977924474 0.0977829153 -0.0961249444 0.0955166707 ## [136] 0.0947785495 0.0929299031 -0.0884373350 -0.0850413793 -0.0824228653 -0.0812306197 0.0755034384 -0.0730146511 0.0707841541 ## [145] -0.0678886226 -0.0678431712 -0.0674346764 0.0664003400 0.0657727492 -0.0654781001 0.0604758951 0.0592823494 -0.0570988592 ## [154] 0.0559417152 0.0554792429 0.0516835513 -0.0501563469 0.0496979471 0.0482635643 -0.0462337926 0.0460694157 -0.0460118164 ## [163] 0.0434196510 0.0414736525 0.0398431020 0.0358978456 -0.0353065495 0.0340554154 0.0330860783 0.0320450478 0.0312025862 ## [172] 0.0290543184 -0.0282860442 -0.0276688124 -0.0268656582 -0.0205277813 0.0199428484 -0.0189964783 0.0167677235 0.0163276144 ## [181] -0.0148074982 0.0147491869 0.0121008836 -0.0119283709 -0.0108655726 -0.0091958320 -0.0080699362 -0.0078104107 -0.0053478687 ## [190] 0.0049479082 -0.0037573453 -0.0037217345 -0.0037147570 -0.0035988507 0.0034517318 0.0028603459 0.0019649759 -0.0013964374 ## [199] 0.0012090716 -0.0006822893 0.0005137457 0.0004537414 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 6550 114815 3897 131408 92799 3897 83744 10579 8567 ## -0.7386234447 0.7234788392 -0.7038045357 -0.6767915011 0.6375013660 -0.6348159210 -0.6326628316 -0.6183222312 0.6174028876 ## 60312 80823 55619 7168 8618 1639 23061 817 64840 ## -0.6140461704 -0.6090158816 -0.6061716878 -0.6056684642 -0.5904575645 -0.5516013241 -0.5371580583 -0.5060305047 -0.4982807580 ## 9776 55215 728340 10497 2044 54899 5530 3084 22872 ## -0.4807004864 0.4793950287 -0.4597016162 -0.4537595538 -0.4170725114 -0.4125588465 -0.4023926271 0.4023150393 -0.4011637408 ## 408 9612 23187 23552 5567 2542 483 253982 83707 ## -0.4008816599 -0.4000936554 -0.3961706940 -0.3846735935 0.3804743706 -0.3801249848 -0.3787195015 0.3732326499 -0.3647345621 ## 23265 79033 162 123803 376497 23041 57553 773 163 ## -0.3545908955 -0.3484162073 -0.3350696756 0.3340303944 -0.3302687735 -0.3128791385 -0.3127745804 -0.3089303409 -0.3011135743 ## 92558 6185 2710 93589 6092 23265 4629 145389 667 ## -0.2851575359 0.2805972602 -0.2796040305 -0.2781290345 -0.2737303878 -0.2705194645 -0.2661378464 -0.2627351309 0.2564752438 ## 30837 637 56904 9223 55680 55268 10540 26505 23059 ## -0.2521550892 0.2510039064 0.2499223522 -0.2456948766 0.2428143831 -0.2387547898 -0.2352394178 -0.2248009201 -0.2227803174 ## 55268 581 55839 8715 80003 11235 10210 23059 10540 ## -0.2214999913 -0.2153954570 -0.2137842988 -0.2134123229 0.2072078233 -0.2027331300 -0.2023366651 -0.2008920065 -0.2007350915 ## 55863 2550 26065 10536 54899 10076 25900 23474 4291 ## 0.1981858275 -0.1956600082 -0.1946907931 -0.1936560438 0.1918771838 -0.1907448643 0.1904533776 0.1903463417 0.1834421396 ## 1072 581 4179 399818 3429 130162 4957 9462 51 ## -0.1815393577 -0.1730988832 -0.1681718254 -0.1676786698 -0.1654800446 -0.1650522233 -0.1605138528 0.1593921290 0.1584392564 ## 57666 6923 28990 55101 25909 23368 8479 9832 3159 ## -0.1582708466 0.1561459358 -0.1553110821 0.1524532329 0.1511253529 0.1508286268 -0.1467825838 -0.1454036449 -0.1453129239 ## 11113 51 2710 5893 6923 84807 56990 51490 3145 ## 0.1431509296 -0.1405528325 -0.1390944514 -0.1345836652 0.1344607384 0.1337166473 0.1325263215 -0.1320972171 -0.1268212659 ## 2934 5602 23263 29924 55215 79629 7266 2115 57553 ## -0.1255175715 -0.1234657988 -0.1234367491 0.1228017521 0.1224734400 -0.1183739153 0.1165388302 0.1163248259 -0.1150050172 ## 5939 1742 7920 55700 124935 10152 3429 740 10635 ## -0.1136706999 -0.1133982194 0.1095649637 -0.1092203820 -0.1090249174 0.1081349218 -0.1078565684 0.1021686602 -0.1021405510 ## 94239 7145 22859 5298 1954 57325 2039 254251 4782 ## -0.1017850335 -0.1011212729 -0.1008642737 -0.1005088073 0.0986096766 -0.0977924474 0.0977829153 -0.0961249444 0.0955166707 ## 7335 254251 54496 5238 29966 83707 10673 5434 10051 ## 0.0947785495 0.0929299031 -0.0884373350 -0.0850413793 -0.0824228653 -0.0812306197 0.0755034384 -0.0730146511 0.0707841541 ## 8479 7018 5775 7168 5524 5602 9158 84134 80228 ## -0.0678886226 -0.0678431712 -0.0674346764 0.0664003400 0.0657727492 -0.0654781001 0.0604758951 0.0592823494 -0.0570988592 ## 92799 79990 7168 9223 8869 2710 5727 58485 54963 ## 0.0559417152 0.0554792429 0.0516835513 -0.0501563469 0.0496979471 0.0482635643 -0.0462337926 0.0460694157 -0.0460118164 ## 80823 780776 10533 2115 10025 7515 3895 3145 83707 ## 0.0434196510 0.0414736525 0.0398431020 0.0358978456 -0.0353065495 0.0340554154 0.0330860783 0.0320450478 0.0312025862 ## 10497 10921 30837 3785 729852 7266 118 112869 7335 ## 0.0290543184 -0.0282860442 -0.0276688124 -0.0268656582 -0.0205277813 0.0199428484 -0.0189964783 0.0167677235 0.0163276144 ## 29934 51564 28990 7515 729852 8869 22859 23313 92799 ## -0.0148074982 0.0147491869 0.0121008836 -0.0119283709 -0.0108655726 -0.0091958320 -0.0080699362 -0.0078104107 -0.0053478687 ## 729852 10025 163 10051 5315 23059 5602 56904 163 ## 0.0049479082 -0.0037573453 -0.0037217345 -0.0037147570 -0.0035988507 0.0034517318 0.0028603459 0.0019649759 -0.0013964374 ## 3895 1072 1954 163 ## 0.0012090716 -0.0006822893 0.0005137457 0.0004537414 4.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["go-and-kegg-ptbp1-targets-09.html", "Chapter 5 GO and KEGG: PTBP1 targets 09 5.1 Load the data 5.2 Gene ontology (GO) 5.3 KEGG", " Chapter 5 GO and KEGG: PTBP1 targets 09 5.1 Load the data data_MAPP &lt;- read.table(&quot;inclusion_tables/0.9/ptbp1_exclusive_targets.tsv&quot;, header = T) # select control and cancer columns library(tidyverse) CTRL &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CONTROL_&quot;, names(.))) CANCER &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CANCER_&quot;, names(.))) # use row_t_welch instead of usual t.test function since t.test produces # errors in some cases: t.test error: data are essentially constant # NAs are assigned for problematic cases # https://stats.stackexchange.com/questions/499634/t-test-error-data-are-essentially-constant/499637 library(matrixTests) data_MAPP &lt;- data_MAPP %&gt;% mutate(padj = p.adjust(row_t_welch(CTRL, CANCER)$pvalue, method = &quot;BH&quot;, n=nrow(data_MAPP))) ## Warning: row_t_welch: 53 of the rows were essentially constant. ## First occurrence at row 35 # data_MAPP &lt;- data_MAPP %&gt;% # mutate(pval=row_t_welch(CTRL, CANCER)$pvalue) sum(is.na(data_MAPP$padj)) ## [1] 53 DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 5.2 Gene ontology (GO) 5.2.1 Prepare the gene list # select genes from data_MAPP table based on padj values # threshold is set in index.Rmd: genes_padj_cutoff genes &lt;- na.omit(data_MAPP) %&gt;% arrange(desc(ABSDIFF)) %&gt;% filter(padj &lt; genes_padj_cutoff) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 gene_id5 gene_id6 ## &quot;ENSG00000066230&quot; &quot;ENSG00000198910&quot; &quot;ENSG00000198910&quot; &quot;ENSG00000138162&quot; &quot;ENSG00000135905&quot; &quot;ENSG00000163618&quot; 5.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 5.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 5.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 5.3 KEGG 5.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:1 mapping between keys and columns head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.7386234447 -0.7038045357 -0.6348159210 -0.6183222312 -0.6061716878 -0.5904575645 -0.5516013241 -0.5371580583 -0.5060305047 ## [10] -0.4982807580 -0.4807004864 0.4793950287 -0.4170725114 -0.4125588465 0.4023150393 -0.4011637408 -0.4008816599 -0.4000936554 ## [19] -0.3961706940 -0.3846735935 0.3804743706 -0.3801249848 -0.3787195015 -0.3647345621 -0.3545908955 -0.3350696756 0.3161439703 ## [28] -0.3128791385 -0.3089303409 -0.3011135743 -0.2851575359 -0.2796040305 -0.2705194645 -0.2627351309 0.2564752438 -0.2521550892 ## [37] 0.2510039064 0.2499223522 -0.2456948766 -0.2248009201 -0.2227803174 -0.2153954570 -0.2027331300 -0.2008920065 0.1981858275 ## [46] -0.1962084656 -0.1946907931 -0.1936560438 0.1904533776 0.1834421396 -0.1730988832 0.1717303192 -0.1676786698 -0.1654800446 ## [55] 0.1626484206 0.1561459358 0.1524532329 -0.1467825838 -0.1454036449 -0.1453129239 -0.1405528325 -0.1345836652 0.1344607384 ## [64] 0.1337166473 -0.1234657988 -0.1234367491 0.1228017521 0.1224734400 -0.1150050172 -0.1136706999 -0.1133982194 0.1095649637 ## [73] -0.1092203820 -0.1090249174 0.1081349218 -0.1078565684 0.1021686602 -0.1021405510 -0.1017850335 -0.1011212729 -0.1008642737 ## [82] 0.0955166707 -0.0884373350 -0.0824228653 -0.0812306197 0.0755034384 -0.0730146511 -0.0715218434 -0.0678886226 -0.0674346764 ## [91] -0.0501563469 -0.0462337926 0.0460694157 -0.0460118164 0.0414736525 0.0398431020 -0.0353065495 0.0312025862 0.0284050762 ## [100] -0.0282860442 -0.0276688124 -0.0205277813 -0.0189964783 -0.0148074982 0.0147491869 -0.0108655726 -0.0080699362 -0.0078104107 ## [109] -0.0037217345 -0.0035988507 0.0034517318 -0.0030004128 -0.0013964374 0.0004537414 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 6550 3897 3897 10579 55619 8618 1639 23061 817 ## -0.7386234447 -0.7038045357 -0.6348159210 -0.6183222312 -0.6061716878 -0.5904575645 -0.5516013241 -0.5371580583 -0.5060305047 ## 64840 9776 55215 2044 54899 3084 22872 408 9612 ## -0.4982807580 -0.4807004864 0.4793950287 -0.4170725114 -0.4125588465 0.4023150393 -0.4011637408 -0.4008816599 -0.4000936554 ## 23187 23552 5567 2542 483 83707 23265 162 10669 ## -0.3961706940 -0.3846735935 0.3804743706 -0.3801249848 -0.3787195015 -0.3647345621 -0.3545908955 -0.3350696756 0.3161439703 ## 23041 773 163 92558 2710 23265 145389 667 30837 ## -0.3128791385 -0.3089303409 -0.3011135743 -0.2851575359 -0.2796040305 -0.2705194645 -0.2627351309 0.2564752438 -0.2521550892 ## 637 56904 9223 26505 23059 581 11235 23059 55863 ## 0.2510039064 0.2499223522 -0.2456948766 -0.2248009201 -0.2227803174 -0.2153954570 -0.2027331300 -0.2008920065 0.1981858275 ## 23028 26065 10536 25900 4291 581 501 399818 3429 ## -0.1962084656 -0.1946907931 -0.1936560438 0.1904533776 0.1834421396 -0.1730988832 0.1717303192 -0.1676786698 -0.1654800446 ## 57556 6923 55101 8479 9832 3159 51 5893 6923 ## 0.1626484206 0.1561459358 0.1524532329 -0.1467825838 -0.1454036449 -0.1453129239 -0.1405528325 -0.1345836652 0.1344607384 ## 84807 5602 23263 29924 55215 57553 5939 1742 7920 ## 0.1337166473 -0.1234657988 -0.1234367491 0.1228017521 0.1224734400 -0.1150050172 -0.1136706999 -0.1133982194 0.1095649637 ## 55700 124935 10152 3429 740 10635 94239 7145 22859 ## -0.1092203820 -0.1090249174 0.1081349218 -0.1078565684 0.1021686602 -0.1021405510 -0.1017850335 -0.1011212729 -0.1008642737 ## 4782 54496 29966 83707 10673 5434 192683 8479 5775 ## 0.0955166707 -0.0884373350 -0.0824228653 -0.0812306197 0.0755034384 -0.0730146511 -0.0715218434 -0.0678886226 -0.0674346764 ## 9223 5727 58485 54963 780776 10533 10025 83707 23531 ## -0.0501563469 -0.0462337926 0.0460694157 -0.0460118164 0.0414736525 0.0398431020 -0.0353065495 0.0312025862 0.0284050762 ## 10921 30837 729852 118 29934 51564 729852 22859 23313 ## -0.0282860442 -0.0276688124 -0.0205277813 -0.0189964783 -0.0148074982 0.0147491869 -0.0108655726 -0.0080699362 -0.0078104107 ## 163 5315 23059 1123 163 163 ## -0.0037217345 -0.0035988507 0.0034517318 -0.0030004128 -0.0013964374 0.0004537414 5.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["go-and-kegg-rbfox1-targets-06.html", "Chapter 6 GO and KEGG: RBFOX1 targets 06 6.1 Load the data 6.2 Gene ontology (GO) 6.3 KEGG", " Chapter 6 GO and KEGG: RBFOX1 targets 06 6.1 Load the data data_MAPP &lt;- read.table(&quot;inclusion_tables/0.6/rbfox1_exclusive_targets.tsv&quot;, header = T) # select control and cancer columns library(tidyverse) CTRL &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CONTROL_&quot;, names(.))) CANCER &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CANCER_&quot;, names(.))) # use row_t_welch instead of usual t.test function since t.test produces # errors in some cases: t.test error: data are essentially constant # NAs are assigned for problematic cases # https://stats.stackexchange.com/questions/499634/t-test-error-data-are-essentially-constant/499637 library(matrixTests) data_MAPP &lt;- data_MAPP %&gt;% mutate(padj = p.adjust(row_t_welch(CTRL, CANCER)$pvalue, method = &quot;BH&quot;, n=nrow(data_MAPP))) ## Warning: row_t_welch: 29 of the rows were essentially constant. ## First occurrence at row 13 # data_MAPP &lt;- data_MAPP %&gt;% # mutate(pval=row_t_welch(CTRL, CANCER)$pvalue) sum(is.na(data_MAPP$padj)) ## [1] 29 DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 6.2 Gene ontology (GO) 6.2.1 Prepare the gene list # select genes from data_MAPP table based on padj values # threshold is set in index.Rmd: genes_padj_cutoff genes &lt;- na.omit(data_MAPP) %&gt;% arrange(desc(ABSDIFF)) %&gt;% filter(padj &lt; genes_padj_cutoff) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 gene_id5 gene_id6 ## &quot;ENSG00000128739&quot; &quot;ENSG00000162623&quot; &quot;ENSG00000136153&quot; &quot;ENSG00000151746&quot; &quot;ENSG00000124831&quot; &quot;ENSG00000066427&quot; 6.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 6.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 6.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 6.3 KEGG 6.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:1 mapping between keys and columns head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] 0.690837237 0.577310225 0.401096728 0.382944514 -0.361995945 -0.314248276 -0.260050537 0.242900110 0.237877425 -0.237621079 ## [11] -0.225129908 -0.220808352 -0.209041756 -0.207505831 -0.199712508 0.176254170 0.170387727 -0.167819973 -0.157890447 0.150591208 ## [21] 0.148730810 -0.144259748 0.144017973 0.137094818 0.091228837 0.058470376 -0.044896280 -0.035038742 -0.032856829 0.009616808 ## [31] -0.003924551 -0.000213719 0.000000000 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 6638 127253 4008 636 9208 4287 9223 7994 4711 825 ## 0.690837237 0.577310225 0.401096728 0.382944514 -0.361995945 -0.314248276 -0.260050537 0.242900110 0.237877425 -0.237621079 ## 10580 23543 8882 1456 5923 4008 1176 1974 8073 166614 ## -0.225129908 -0.220808352 -0.209041756 -0.207505831 -0.199712508 0.176254170 0.170387727 -0.167819973 -0.157890447 0.150591208 ## 4711 25854 64327 9474 63895 9117 6567 9101 7073 3094 ## 0.148730810 -0.144259748 0.144017973 0.137094818 0.091228837 0.058470376 -0.044896280 -0.035038742 -0.032856829 0.009616808 ## 9117 3094 825 ## -0.003924551 -0.000213719 0.000000000 6.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["go-and-kegg-rbfox1-targets-09.html", "Chapter 7 GO and KEGG: RBFOX1 targets 09 7.1 Load the data 7.2 Gene ontology (GO) 7.3 KEGG", " Chapter 7 GO and KEGG: RBFOX1 targets 09 7.1 Load the data data_MAPP &lt;- read.table(&quot;inclusion_tables/0.9/rbfox1_exclusive_targets.tsv&quot;, header = T) # select control and cancer columns library(tidyverse) CTRL &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CONTROL_&quot;, names(.))) CANCER &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CANCER_&quot;, names(.))) # use row_t_welch instead of usual t.test function since t.test produces # errors in some cases: t.test error: data are essentially constant # NAs are assigned for problematic cases # https://stats.stackexchange.com/questions/499634/t-test-error-data-are-essentially-constant/499637 library(matrixTests) data_MAPP &lt;- data_MAPP %&gt;% mutate(padj = p.adjust(row_t_welch(CTRL, CANCER)$pvalue, method = &quot;BH&quot;, n=nrow(data_MAPP))) ## Warning: row_t_welch: 26 of the rows were essentially constant. ## First occurrence at row 9 # data_MAPP &lt;- data_MAPP %&gt;% # mutate(pval=row_t_welch(CTRL, CANCER)$pvalue) sum(is.na(data_MAPP$padj)) ## [1] 26 DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 7.2 Gene ontology (GO) 7.2.1 Prepare the gene list # select genes from data_MAPP table based on padj values # threshold is set in index.Rmd: genes_padj_cutoff genes &lt;- na.omit(data_MAPP) %&gt;% arrange(desc(ABSDIFF)) %&gt;% filter(padj &lt; genes_padj_cutoff) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 gene_id5 gene_id6 ## &quot;ENSG00000128739&quot; &quot;ENSG00000162623&quot; &quot;ENSG00000151746&quot; &quot;ENSG00000124831&quot; &quot;ENSG00000066427&quot; &quot;ENSG00000151276&quot; 7.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 7.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 7.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 7.3 KEGG 7.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:1 mapping between keys and columns head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] 0.690837237 0.577310225 0.382944514 -0.361995945 -0.314248276 -0.260050537 0.242900110 0.237877425 -0.237621079 -0.225129908 ## [11] -0.220808352 -0.209041756 -0.207505831 -0.199712508 0.170387727 -0.167819973 -0.157890447 0.150591208 0.148730810 -0.144259748 ## [21] 0.144017973 0.137094818 0.091228837 0.058470376 -0.035038742 -0.032856829 -0.003924551 0.000000000 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 6638 127253 636 9208 4287 9223 7994 4711 825 10580 ## 0.690837237 0.577310225 0.382944514 -0.361995945 -0.314248276 -0.260050537 0.242900110 0.237877425 -0.237621079 -0.225129908 ## 23543 8882 1456 5923 1176 1974 8073 166614 4711 25854 ## -0.220808352 -0.209041756 -0.207505831 -0.199712508 0.170387727 -0.167819973 -0.157890447 0.150591208 0.148730810 -0.144259748 ## 64327 9474 63895 9117 9101 7073 9117 825 ## 0.144017973 0.137094818 0.091228837 0.058470376 -0.035038742 -0.032856829 -0.003924551 0.000000000 7.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["go-and-kegg-non-targets-06.html", "Chapter 8 GO and KEGG: non targets 06 8.1 Load the data 8.2 Gene ontology (GO) 8.3 KEGG", " Chapter 8 GO and KEGG: non targets 06 8.1 Load the data data_MAPP &lt;- read.table(&quot;inclusion_tables/0.6/non_targets.tsv&quot;, header = T) # select control and cancer columns library(tidyverse) CTRL &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CONTROL_&quot;, names(.))) CANCER &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CANCER_&quot;, names(.))) # use row_t_welch instead of usual t.test function since t.test produces # errors in some cases: t.test error: data are essentially constant # NAs are assigned for problematic cases # https://stats.stackexchange.com/questions/499634/t-test-error-data-are-essentially-constant/499637 library(matrixTests) data_MAPP &lt;- data_MAPP %&gt;% mutate(padj = p.adjust(row_t_welch(CTRL, CANCER)$pvalue, method = &quot;BH&quot;, n=nrow(data_MAPP))) ## Warning: row_t_welch: 82 of the rows were essentially constant. ## First occurrence at row 1 # data_MAPP &lt;- data_MAPP %&gt;% # mutate(pval=row_t_welch(CTRL, CANCER)$pvalue) sum(is.na(data_MAPP$padj)) ## [1] 82 DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 8.2 Gene ontology (GO) 8.2.1 Prepare the gene list # select genes from data_MAPP table based on padj values # threshold is set in index.Rmd: genes_padj_cutoff genes &lt;- na.omit(data_MAPP) %&gt;% arrange(desc(ABSDIFF)) %&gt;% filter(padj &lt; genes_padj_cutoff) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 gene_id5 gene_id6 ## &quot;ENSG00000196776&quot; &quot;ENSG00000102271&quot; &quot;ENSG00000149636&quot; &quot;ENSG00000109805&quot; &quot;ENSG00000138078&quot; &quot;ENSG00000058091&quot; 8.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 8.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 8.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 8.3 KEGG 8.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:many mapping between keys and columns head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.866506924 -0.659072802 0.510542059 -0.418313583 0.402566080 0.383206663 -0.372208614 -0.352828023 -0.343327475 -0.328634971 ## [11] -0.325454472 0.316591691 0.316401061 -0.309703567 -0.300101926 0.298972554 0.289326326 -0.276265372 -0.273459403 0.249998857 ## [21] 0.249998857 0.241861817 -0.234615217 -0.226314398 0.220021682 0.219873591 0.218977682 -0.216836466 -0.216015887 0.215664424 ## [31] -0.198543716 -0.193468626 -0.192606895 -0.178571654 -0.174016829 0.170521309 -0.167857431 0.158662091 0.155321273 -0.154157988 ## [41] 0.153179153 -0.150818161 -0.142754980 0.137698349 0.109984803 0.107074005 -0.099228726 -0.096491295 0.091762087 0.084344634 ## [51] -0.062207711 0.058660015 -0.052500897 0.051637080 0.049500900 0.047042407 -0.043444025 -0.043248934 0.038903354 0.034200950 ## [61] 0.029926820 -0.027969573 0.026843593 0.023857447 0.012890170 -0.012334276 -0.010469745 -0.008625834 0.007682573 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 961 56062 79980 64151 9581 5218 10138 9321 220869 23484 ## -0.866506924 -0.659072802 0.510542059 -0.418313583 0.402566080 0.383206663 -0.372208614 -0.352828023 -0.343327475 -0.328634971 ## 5058 55680 27005 55905 133015 79980 199704 7220 727957 6606 ## -0.325454472 0.316591691 0.316401061 -0.309703567 -0.300101926 0.298972554 0.289326326 -0.276265372 -0.273459403 0.249998857 ## 6607 79632 23300 57488 55051 55681 2186 54832 3093 7871 ## 0.249998857 0.241861817 -0.234615217 -0.226314398 0.220021682 0.219873591 0.218977682 -0.216836466 -0.216015887 0.215664424 ## 7884 1964 80232 80315 56940 6124 55740 25950 339487 1499 ## -0.198543716 -0.193468626 -0.192606895 -0.178571654 -0.174016829 0.170521309 -0.167857431 0.158662091 0.155321273 -0.154157988 ## 286144 130271 1894 161823 311 51389 9556 79068 10923 114625 ## 0.153179153 -0.150818161 -0.142754980 0.137698349 0.109984803 0.107074005 -0.099228726 -0.096491295 0.091762087 0.084344634 ## 9444 1207 6632 51592 1207 8822 79096 8803 27005 10138 ## -0.062207711 0.058660015 -0.052500897 0.051637080 0.049500900 0.047042407 -0.043444025 -0.043248934 0.038903354 0.034200950 ## 8575 262 10856 25764 55681 5571 127829 22796 8575 ## 0.029926820 -0.027969573 0.026843593 0.023857447 0.012890170 -0.012334276 -0.010469745 -0.008625834 0.007682573 8.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["go-and-kegg-non-targets-09.html", "Chapter 9 GO and KEGG: non targets 09 9.1 Load the data 9.2 Gene ontology (GO) 9.3 KEGG", " Chapter 9 GO and KEGG: non targets 09 9.1 Load the data data_MAPP &lt;- read.table(&quot;inclusion_tables/0.9/non_targets.tsv&quot;, header = T) # select control and cancer columns library(tidyverse) CTRL &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CONTROL_&quot;, names(.))) CANCER &lt;- data_MAPP %&gt;% dplyr::select_if(., grepl(&quot;^CANCER_&quot;, names(.))) # use row_t_welch instead of usual t.test function since t.test produces # errors in some cases: t.test error: data are essentially constant # NAs are assigned for problematic cases # https://stats.stackexchange.com/questions/499634/t-test-error-data-are-essentially-constant/499637 library(matrixTests) data_MAPP &lt;- data_MAPP %&gt;% mutate(padj = p.adjust(row_t_welch(CTRL, CANCER)$pvalue, method = &quot;BH&quot;, n=nrow(data_MAPP))) ## Warning: row_t_welch: 82 of the rows were essentially constant. ## First occurrence at row 1 # data_MAPP &lt;- data_MAPP %&gt;% # mutate(pval=row_t_welch(CTRL, CANCER)$pvalue) sum(is.na(data_MAPP$padj)) ## [1] 82 DT::datatable(data_MAPP, options = list(scrollX = TRUE)) 9.2 Gene ontology (GO) 9.2.1 Prepare the gene list # select genes from data_MAPP table based on padj values # threshold is set in index.Rmd: genes_padj_cutoff genes &lt;- na.omit(data_MAPP) %&gt;% arrange(desc(ABSDIFF)) %&gt;% filter(padj &lt; genes_padj_cutoff) %&gt;% dplyr::select(gene_id) %&gt;% unlist() genes &lt;- unlist(strsplit(genes, &quot;,&quot;)) head(genes) ## gene_id1 gene_id2 gene_id3 gene_id4 gene_id5 gene_id6 ## &quot;ENSG00000196776&quot; &quot;ENSG00000102271&quot; &quot;ENSG00000149636&quot; &quot;ENSG00000109805&quot; &quot;ENSG00000138078&quot; &quot;ENSG00000058091&quot; 9.2.2 Biological process (BP) type_of_GO = &quot;BP&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 9.2.3 Molecular function (MF) type_of_GO = &quot;MF&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 9.2.4 Cellular component (CC) type_of_GO = &quot;CC&quot; assign(paste0(&quot;GO_&quot;, type_of_GO), enrichGO( genes, organismDB, keyType = &quot;ENSEMBL&quot;, ont = type_of_GO, pvalueCutoff = pvalueCutoff, minGSSize = minGSSize, pAdjustMethod = &quot;BH&quot;, universe = universe, readable = TRUE)) df_GO &lt;- eval(parse(text = paste0(&quot;GO_&quot;, type_of_GO))) if(nrow(df_GO) &gt; 0){ DT::datatable(df_GO@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no GOs were found&quot; ## [1] &quot;no GOs were found&quot; if(nrow(df_GO) &gt; 0){ barplot(df_GO, showCategory = showCategory, title = type_of_GO) } else &quot;no GOs to plot&quot; ## [1] &quot;no GOs to plot&quot; 9.3 KEGG 9.3.1 Prepare the the data # select gene_id in ENSEMBL format and DIFF from the result table DIFF &lt;- data_MAPP %&gt;% dplyr::select(gene_id, DIFF) # rename the gene_id column names(DIFF)[1] &lt;- &quot;ENSEMBL&quot; head(DIFF) # create new df by converting ENSEMBL ID into ENTREZID and adding DIFF column # sort table by in descending order by abs(DIFF) genes_ENTREZ_df &lt;- bitr(na.omit(data_MAPP$gene_id[data_MAPP$padj &lt; genes_padj_cutoff]), fromType = &quot;ENSEMBL&quot;, toType = &quot;ENTREZID&quot;, OrgDb= organismDB) %&gt;% left_join(DIFF, by = &quot;ENSEMBL&quot;) %&gt;% arrange(desc(abs(DIFF))) ## &#39;select()&#39; returned 1:many mapping between keys and columns head(genes_ENTREZ_df ) # create a vector with DIFF values genes_DIFF &lt;- genes_ENTREZ_df$DIFF genes_DIFF ## [1] -0.866506924 -0.659072802 0.510542059 -0.418313583 0.402566080 0.383206663 -0.372208614 -0.352828023 -0.343327475 -0.328634971 ## [11] -0.325454472 0.316591691 0.316401061 -0.309703567 -0.300101926 0.298972554 0.289326326 -0.276265372 -0.273459403 0.249998857 ## [21] 0.249998857 0.241861817 -0.234615217 -0.226314398 0.220021682 0.219873591 0.218977682 -0.216836466 -0.216015887 0.215664424 ## [31] -0.198543716 -0.193468626 -0.192606895 -0.178571654 -0.174016829 0.170521309 -0.167857431 0.158662091 0.155321273 -0.154157988 ## [41] 0.153179153 -0.150818161 -0.142754980 0.137698349 0.109984803 0.107074005 -0.099228726 -0.096491295 0.091762087 0.084344634 ## [51] -0.062207711 0.058660015 -0.052500897 0.051637080 0.049500900 0.047042407 -0.043444025 -0.043248934 0.038903354 0.034200950 ## [61] 0.029926820 -0.027969573 0.026843593 0.023857447 0.012890170 -0.012334276 -0.010469745 -0.008625834 0.007682573 # add names based on ENTREZID names(genes_DIFF) &lt;- genes_ENTREZ_df$ENTREZID genes_DIFF ## 961 56062 79980 64151 9581 5218 10138 9321 220869 23484 ## -0.866506924 -0.659072802 0.510542059 -0.418313583 0.402566080 0.383206663 -0.372208614 -0.352828023 -0.343327475 -0.328634971 ## 5058 55680 27005 55905 133015 79980 199704 7220 727957 6606 ## -0.325454472 0.316591691 0.316401061 -0.309703567 -0.300101926 0.298972554 0.289326326 -0.276265372 -0.273459403 0.249998857 ## 6607 79632 23300 57488 55051 55681 2186 54832 3093 7871 ## 0.249998857 0.241861817 -0.234615217 -0.226314398 0.220021682 0.219873591 0.218977682 -0.216836466 -0.216015887 0.215664424 ## 7884 1964 80232 80315 56940 6124 55740 25950 339487 1499 ## -0.198543716 -0.193468626 -0.192606895 -0.178571654 -0.174016829 0.170521309 -0.167857431 0.158662091 0.155321273 -0.154157988 ## 286144 130271 1894 161823 311 51389 9556 79068 10923 114625 ## 0.153179153 -0.150818161 -0.142754980 0.137698349 0.109984803 0.107074005 -0.099228726 -0.096491295 0.091762087 0.084344634 ## 9444 1207 6632 51592 1207 8822 79096 8803 27005 10138 ## -0.062207711 0.058660015 -0.052500897 0.051637080 0.049500900 0.047042407 -0.043444025 -0.043248934 0.038903354 0.034200950 ## 8575 262 10856 25764 55681 5571 127829 22796 8575 ## 0.029926820 -0.027969573 0.026843593 0.023857447 0.012890170 -0.012334276 -0.010469745 -0.008625834 0.007682573 9.3.2 run KEGG KEGGresults &lt;- enrichKEGG( names(genes_DIFF), organism = &quot;hsa&quot;, keyType = &quot;ncbi-geneid&quot;, pvalueCutoff = pvalueCutoff, pAdjustMethod = &quot;BH&quot;, universe = as.character(na.omit(ENTREZ_universe)), use_internal_data = FALSE ) if(nrow(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff)) &gt; 0){ DT::datatable(KEGGresults@result %&gt;% filter(p.adjust &lt; pvalueCutoff), options = list(scrollX = TRUE)) } else &quot;no KEGG pathways were found&quot; ## [1] &quot;no KEGG pathways were found&quot; "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
